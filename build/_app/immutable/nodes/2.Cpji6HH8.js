import"../chunks/CWj6FrbW.js";import{i as ln}from"../chunks/BMNbMCHS.js";import{g as Qt,w as Vt,s as _e,o as kr,e as ut,b as pa,c as ma}from"../chunks/aOIIPDym.js";import{ac as ga,v as va,B as xn,w as Oe,ag as Zt,x as or,h as u,X as Xe,y as _a,z as ya,A as Lr,C as Xn,I as yt,ae as yi,aj as wa,D as wi,F as xi,G as xa,az as jn,an as bi,aa as sr,aA as Or,P as we,aB as Pr,ab as ba,aC as Ar,aD as ka,am as Aa,aE as Ea,aF as Ia,aG as Er,aH as Ma,af as ki,aI as Ai,L as Ca,aJ as Na,t as Ne,aK as Sa,ak as Ta,ai as Ra,ap as Fr,aL as Da,aM as La,aN as Oa,aO as Pa,aP as Fa,R as $a,M as Ha,p as cn,aQ as kt,Q as ae,i as fe,aR as Bn,l as xe,n as H,q as ie,o as $,a as de,m as un,aS as Ge,e as W,a5 as Ba,aT as za,c as Lt,f as mt,a6 as Jn,aU as Ua}from"../chunks/C6KLtY3n.js";import{p as Ie,b as At,s as et,i as Ae,a as Ei}from"../chunks/CAJribfZ.js";import{s as qa,g as Wa}from"../chunks/quCaQKYO.js";function Cn(e,t){return t}function Va(e,t,n,r){for(var i=[],a=t.length,o=0;o<a;o++)ka(t[o].e,i,!0);var l=a>0&&i.length===0&&n!==null;if(l){var c=n.parentNode;Aa(c),c.append(n),r.clear(),pt(e,t[0].prev,t[a-1].next)}Ea(i,()=>{for(var s=0;s<a;s++){var f=t[s];l||(r.delete(f.k),pt(e,f.prev,f.next)),Ia(f.e,!l)}})}function Nn(e,t,n,r,i,a=null){var o=e,l={flags:t,items:new Map,first:null},c=(t&Ai)!==0;if(c){var s=e;o=Oe?xn(Zt(s)):s.appendChild(ga())}Oe&&or();var f=null,p=!1,h=Xe(()=>{var v=n();return ba(v)?v:v==null?[]:bi(v)});va(()=>{var v=u(h),_=v.length;if(p&&_===0)return;p=_===0;let S=!1;if(Oe){var R=_a(o)===ya;R!==(_===0)&&(o=Lr(),xn(o),Xn(!1),S=!0)}if(Oe){for(var q=null,Q,V=0;V<_;V++){if(yt.nodeType===yi&&yt.data===wa){o=yt,S=!0,Xn(!1);break}var z=v[V],U=r(z,V);Q=Ii(yt,l,q,null,z,U,V,i,t,n),l.items.set(U,Q),q=Q}_>0&&xn(Lr())}Oe||Ya(v,l,o,i,t,r,n),a!==null&&(_===0?f?wi(f):f=xi(()=>a(o)):f!==null&&xa(f,()=>{f=null})),S&&Xn(!0),u(h)}),Oe&&(o=yt)}function Ya(e,t,n,r,i,a,o){var Y,te,K,N;var l=(i&Na)!==0,c=(i&(Er|Ar))!==0,s=e.length,f=t.items,p=t.first,h=p,v,_=null,S,R=[],q=[],Q,V,z,U;if(l)for(U=0;U<s;U+=1)Q=e[U],V=a(Q,U),z=f.get(V),z!==void 0&&((Y=z.a)==null||Y.measure(),(S??(S=new Set)).add(z));for(U=0;U<s;U+=1){if(Q=e[U],V=a(Q,U),z=f.get(V),z===void 0){var me=h?h.e.nodes_start:n;_=Ii(me,t,_,_===null?t.first:_.next,Q,V,U,r,i,o),f.set(V,_),R=[],q=[],h=_.next;continue}if(c&&Ga(z,Q,U,i),(z.e.f&jn)!==0&&(wi(z.e),l&&((te=z.a)==null||te.unfix(),(S??(S=new Set)).delete(z))),z!==h){if(v!==void 0&&v.has(z)){if(R.length<q.length){var Z=q[0],d;_=Z.prev;var m=R[0],y=R[R.length-1];for(d=0;d<R.length;d+=1)$r(R[d],Z,n);for(d=0;d<q.length;d+=1)v.delete(q[d]);pt(t,m.prev,y.next),pt(t,_,m),pt(t,y,Z),h=Z,_=y,U-=1,R=[],q=[]}else v.delete(z),$r(z,h,n),pt(t,z.prev,z.next),pt(t,z,_===null?t.first:_.next),pt(t,_,z),_=z;continue}for(R=[],q=[];h!==null&&h.k!==V;)(h.e.f&jn)===0&&(v??(v=new Set)).add(h),q.push(h),h=h.next;if(h===null)continue;z=h}R.push(z),_=z,h=z.next}if(h!==null||v!==void 0){for(var w=v===void 0?[]:bi(v);h!==null;)(h.e.f&jn)===0&&w.push(h),h=h.next;var g=w.length;if(g>0){var M=(i&Ai)!==0&&s===0?n:null;if(l){for(U=0;U<g;U+=1)(K=w[U].a)==null||K.measure();for(U=0;U<g;U+=1)(N=w[U].a)==null||N.fix()}Va(t,w,M,f)}}l&&Ca(()=>{var j;if(S!==void 0)for(z of S)(j=z.a)==null||j.apply()}),sr.first=t.first&&t.first.e,sr.last=_&&_.e}function Ga(e,t,n,r){(r&Er)!==0&&Or(e.v,t),(r&Ar)!==0?Or(e.i,n):e.i=n}function Ii(e,t,n,r,i,a,o,l,c,s){var f=(c&Er)!==0,p=(c&Ma)===0,h=f?p?we(i,!1,!1):Pr(i):i,v=(c&Ar)===0?o:Pr(o),_={i:v,v:h,k:a,a:null,e:null,prev:n,next:r};try{return _.e=xi(()=>l(e,h,v,s),Oe),_.e.prev=n&&n.e,_.e.next=r&&r.e,n===null?t.first=_:(n.next=_,n.e.next=_.e),r!==null&&(r.prev=_,r.e.prev=_.e),_}finally{}}function $r(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,i=t?t.e.nodes_start:n,a=e.e.nodes_start;a!==r;){var o=ki(a);i.before(a),a=o}}function pt(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function Qn(e,t,n=!1,r=!1,i=!1){var a=e,o="";Ne(()=>{var l=sr;if(o===(o=t()??"")){Oe&&or();return}if(l.nodes_start!==null&&(Sa(l.nodes_start,l.nodes_end),l.nodes_start=l.nodes_end=null),o!==""){if(Oe){yt.data;for(var c=or(),s=c;c!==null&&(c.nodeType!==yi||c.data!=="");)s=c,c=ki(c);if(c===null)throw Ta(),Ra;Fr(yt,s),a=xn(c);return}var f=o+"";n?f=`<svg>${f}</svg>`:r&&(f=`<math>${f}</math>`);var p=Da(f);if((n||r)&&(p=Zt(p)),Fr(Zt(p),p.lastChild),n||r)for(;Zt(p);)a.before(Zt(p));else a.before(p)}})}const Hr=[...` 	
\r\fÂ \v\uFEFF`];function Ka(e,t,n){var r=e==null?"":""+e;if(n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var a=i.length,o=0;(o=r.indexOf(i,o))>=0;){var l=o+a;(o===0||Hr.includes(r[o-1]))&&(l===r.length||Hr.includes(r[l]))?r=(o===0?"":r.substring(0,o))+r.substring(l+1):o=l}}return r===""?null:r}function Xa(e,t){return e==null?null:String(e)}function Ot(e,t,n,r,i,a){var o=e.__className;if(Oe||o!==n||o===void 0){var l=Ka(n,r,a);(!Oe||l!==e.getAttribute("class"))&&(l==null?e.removeAttribute("class"):e.className=l),e.__className=n}else if(a&&i!==a)for(var c in a){var s=!!a[c];(i==null||s!==!!i[c])&&e.classList.toggle(c,s)}return a}function Mi(e,t,n,r){var i=e.__style;if(Oe||i!==t){var a=Xa(t);(!Oe||a!==e.getAttribute("style"))&&(a==null?e.removeAttribute("style"):e.style.cssText=a),e.__style=t}return r}const ja=Symbol("is custom element"),Ja=Symbol("is html");function lr(e,t,n,r){var i=Qa(e);Oe&&(i[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||i[t]!==(i[t]=n)&&(t==="loading"&&(e[Fa]=n),n==null?e.removeAttribute(t):typeof n!="string"&&Za(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function Qa(e){return e.__attributes??(e.__attributes={[ja]:e.nodeName.includes("-"),[Ja]:e.namespaceURI===La})}var Br=new Map;function Za(e){var t=Br.get(e.nodeName);if(t)return t;Br.set(e.nodeName,t=[]);for(var n,r=e,i=Element.prototype;i!==r;){n=Pa(r);for(var a in n)n[a].set&&t.push(a);r=Oa(r)}return t}const eo=()=>performance.now(),tt={tick:e=>requestAnimationFrame(e),now:()=>eo(),tasks:new Set};function Ci(){const e=tt.now();tt.tasks.forEach(t=>{t.c(e)||(tt.tasks.delete(t),t.f())}),tt.tasks.size!==0&&tt.tick(Ci)}function to(e){let t;return tt.tasks.size===0&&tt.tick(Ci),{promise:new Promise(n=>{tt.tasks.add(t={c:e,f:n})}),abort(){tt.tasks.delete(t)}}}function no(e,t,n){var r=$a(e,t);r&&r.set&&(e[t]=n,Ha(()=>{e[t]=null}))}function ro(e){return function(...t){var n=t[0];return n.stopPropagation(),e==null?void 0:e.apply(this,t)}}function io(e){return function(...t){var n=t[0];return n.preventDefault(),e==null?void 0:e.apply(this,t)}}const ao=()=>{const e=qa;return{page:{subscribe:e.page.subscribe},navigating:{subscribe:e.navigating.subscribe},updated:e.updated}},oo={subscribe(e){return ao().page.subscribe(e)}},so={"tcja-expiration":{filename:"household_tax_income_changes_senate_current_law_baseline.csv",label:"TCJA expiration",description:"Analysis showing impact if TCJA provisions expire"},"tcja-extension":{filename:"household_tax_income_changes_senate_tcja_baseline.csv",label:"TCJA extension",description:"Analysis showing impact if TCJA provisions are extended"}},cr=so,lo=[{id:"intro",title:"How the reconciliation bill affects 40,000 households",groupText:"On July 4, President Donald Trump signed into law the One Big Beautiful Bill Act (OBBBA). The bill extended the 2017 tax cuts, enacted additional tax reforms, and reduced spending on programs like Medicaid.<br><br>We've calculated how these changes will affect 40,000 representative households in 2026. Scroll through to see these impacts across the income spectrum.",view:{xDomain:[-20,20],yDomain:[0,35e4],filter:e=>e["Market Income"]<35e4,highlightGroup:null}},{id:"lower-income",title:"Households with income below $50,000",groupText:null,view:{xDomain:[-20,20],yDomain:[0,5e4],filter:e=>e["Market Income"]>=0&&e["Market Income"]<5e4,highlightGroup:"lower"}},{id:"middle-income",title:"Households with income $50,000 - $200,000",groupText:null,view:{xDomain:[-20,20],yDomain:[5e4,2e5],filter:e=>e["Market Income"]>=5e4&&e["Market Income"]<2e5,highlightGroup:"middle"}},{id:"upper-income",title:"Households with income $200,000 - $1 million",groupText:null,view:{xDomain:[-20,20],yDomain:[2e5,1e6],filter:e=>e["Market Income"]>=2e5&&e["Market Income"]<1e6,highlightGroup:"upper"}},{id:"highest-income",title:"Households with income over $1 million",groupText:null,view:{xDomain:[-20,20],yDomain:[1e6,1e7],filter:e=>e["Market Income"]>=1e6,highlightGroup:"highest"}},{id:"all-households",title:"All households",groupText:"Overall, OBBBA affects {totalPercentage}% of households. The median household experiences a {medianImpact}% change in net income.<br><br>Visit <a href='https://policyengine.org' target='_blank' style='color: var(--primary-blue); text-decoration: underline;'>PolicyEngine.org</a> to explore more of our free, open source tools and policy research. Calculate your own tax impact, design custom reforms, and analyze their effects on poverty, inequality, and government revenues.",view:{xDomain:[-20,20],yDomain:[0,1e7],filter:e=>!0,highlightGroup:null}}];function co(){const e=[];return lo.forEach((t,n)=>{e.push({id:t.id,...t.view,title:t.title,description:t.groupText,viewType:"group"})}),e}const $e=co();function uo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var bn={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var fo=bn.exports,zr;function ho(){return zr||(zr=1,function(e,t){((n,r)=>{e.exports=r()})(fo,function n(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},i,a=!r.document&&!!r.postMessage,o=r.IS_PAPA_WORKER||!1,l={},c=0,s={};function f(d){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(m){var y=U(m);y.chunkSize=parseInt(y.chunkSize),m.step||m.chunk||(y.chunkSize=null),this._handle=new S(y),(this._handle.streamer=this)._config=y}).call(this,d),this.parseChunk=function(m,y){var w=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<w){let M=this._config.newline;M||(g=this._config.quoteChar||'"',M=this._handle.guessLineEndings(m,g)),m=[...m.split(M).slice(w)].join(M)}this.isFirstChunk&&Z(this._config.beforeFirstChunk)&&(g=this._config.beforeFirstChunk(m))!==void 0&&(m=g),this.isFirstChunk=!1,this._halted=!1;var w=this._partialLine+m,g=(this._partialLine="",this._handle.parse(w,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(m=g.meta.cursor,w=(this._finished||(this._partialLine=w.substring(m-this._baseIndex),this._baseIndex=m),g&&g.data&&(this._rowCount+=g.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)r.postMessage({results:g,workerId:s.WORKER_ID,finished:w});else if(Z(this._config.chunk)&&!y){if(this._config.chunk(g,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=g=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(g.data),this._completeResults.errors=this._completeResults.errors.concat(g.errors),this._completeResults.meta=g.meta),this._completed||!w||!Z(this._config.complete)||g&&g.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),w||g&&g.meta.paused||this._nextChunk(),g}this._halted=!0},this._sendError=function(m){Z(this._config.error)?this._config.error(m):o&&this._config.error&&r.postMessage({workerId:s.WORKER_ID,error:m,finished:!1})}}function p(d){var m;(d=d||{}).chunkSize||(d.chunkSize=s.RemoteChunkSize),f.call(this,d),this._nextChunk=a?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(y){this._input=y,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(m=new XMLHttpRequest,this._config.withCredentials&&(m.withCredentials=this._config.withCredentials),a||(m.onload=me(this._chunkLoaded,this),m.onerror=me(this._chunkError,this)),m.open(this._config.downloadRequestBody?"POST":"GET",this._input,!a),this._config.downloadRequestHeaders){var y,w=this._config.downloadRequestHeaders;for(y in w)m.setRequestHeader(y,w[y])}var g;this._config.chunkSize&&(g=this._start+this._config.chunkSize-1,m.setRequestHeader("Range","bytes="+this._start+"-"+g));try{m.send(this._config.downloadRequestBody)}catch(M){this._chunkError(M.message)}a&&m.status===0&&this._chunkError()}},this._chunkLoaded=function(){m.readyState===4&&(m.status<200||400<=m.status?this._chunkError():(this._start+=this._config.chunkSize||m.responseText.length,this._finished=!this._config.chunkSize||this._start>=(y=>(y=y.getResponseHeader("Content-Range"))!==null?parseInt(y.substring(y.lastIndexOf("/")+1)):-1)(m),this.parseChunk(m.responseText)))},this._chunkError=function(y){y=m.statusText||y,this._sendError(new Error(y))}}function h(d){(d=d||{}).chunkSize||(d.chunkSize=s.LocalChunkSize),f.call(this,d);var m,y,w=typeof FileReader<"u";this.stream=function(g){this._input=g,y=g.slice||g.webkitSlice||g.mozSlice,w?((m=new FileReader).onload=me(this._chunkLoaded,this),m.onerror=me(this._chunkError,this)):m=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var g=this._input,M=(this._config.chunkSize&&(M=Math.min(this._start+this._config.chunkSize,this._input.size),g=y.call(g,this._start,M)),m.readAsText(g,this._config.encoding));w||this._chunkLoaded({target:{result:M}})},this._chunkLoaded=function(g){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(g.target.result)},this._chunkError=function(){this._sendError(m.error)}}function v(d){var m;f.call(this,d=d||{}),this.stream=function(y){return m=y,this._nextChunk()},this._nextChunk=function(){var y,w;if(!this._finished)return y=this._config.chunkSize,m=y?(w=m.substring(0,y),m.substring(y)):(w=m,""),this._finished=!m,this.parseChunk(w)}}function _(d){f.call(this,d=d||{});var m=[],y=!0,w=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(g){this._input=g,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){w&&m.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),m.length?this.parseChunk(m.shift()):y=!0},this._streamData=me(function(g){try{m.push(typeof g=="string"?g:g.toString(this._config.encoding)),y&&(y=!1,this._checkIsFinished(),this.parseChunk(m.shift()))}catch(M){this._streamError(M)}},this),this._streamError=me(function(g){this._streamCleanUp(),this._sendError(g)},this),this._streamEnd=me(function(){this._streamCleanUp(),w=!0,this._streamData("")},this),this._streamCleanUp=me(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function S(d){var m,y,w,g,M=Math.pow(2,53),Y=-M,te=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,K=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,N=this,j=0,T=0,L=!1,C=!1,D=[],E={data:[],errors:[],meta:{}};function X(ee){return d.skipEmptyLines==="greedy"?ee.join("").trim()==="":ee.length===1&&ee[0].length===0}function O(){if(E&&w&&(be("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),w=!1),d.skipEmptyLines&&(E.data=E.data.filter(function(k){return!X(k)})),re()){let k=function(F,G){Z(d.transformHeader)&&(F=d.transformHeader(F,G)),D.push(F)};if(E)if(Array.isArray(E.data[0])){for(var ee=0;re()&&ee<E.data.length;ee++)E.data[ee].forEach(k);E.data.splice(0,1)}else E.data.forEach(k)}function x(k,F){for(var G=d.header?{}:[],I=0;I<k.length;I++){var P=I,A=k[I],A=((J,B)=>(oe=>(d.dynamicTypingFunction&&d.dynamicTyping[oe]===void 0&&(d.dynamicTyping[oe]=d.dynamicTypingFunction(oe)),(d.dynamicTyping[oe]||d.dynamicTyping)===!0))(J)?B==="true"||B==="TRUE"||B!=="false"&&B!=="FALSE"&&((oe=>{if(te.test(oe)&&(oe=parseFloat(oe),Y<oe&&oe<M))return 1})(B)?parseFloat(B):K.test(B)?new Date(B):B===""?null:B):B)(P=d.header?I>=D.length?"__parsed_extra":D[I]:P,A=d.transform?d.transform(A,P):A);P==="__parsed_extra"?(G[P]=G[P]||[],G[P].push(A)):G[P]=A}return d.header&&(I>D.length?be("FieldMismatch","TooManyFields","Too many fields: expected "+D.length+" fields but parsed "+I,T+F):I<D.length&&be("FieldMismatch","TooFewFields","Too few fields: expected "+D.length+" fields but parsed "+I,T+F)),G}var b;E&&(d.header||d.dynamicTyping||d.transform)&&(b=1,!E.data.length||Array.isArray(E.data[0])?(E.data=E.data.map(x),b=E.data.length):E.data=x(E.data,0),d.header&&E.meta&&(E.meta.fields=D),T+=b)}function re(){return d.header&&D.length===0}function be(ee,x,b,k){ee={type:ee,code:x,message:b},k!==void 0&&(ee.row=k),E.errors.push(ee)}Z(d.step)&&(g=d.step,d.step=function(ee){E=ee,re()?O():(O(),E.data.length!==0&&(j+=ee.data.length,d.preview&&j>d.preview?y.abort():(E.data=E.data[0],g(E,N))))}),this.parse=function(ee,x,b){var k=d.quoteChar||'"',k=(d.newline||(d.newline=this.guessLineEndings(ee,k)),w=!1,d.delimiter?Z(d.delimiter)&&(d.delimiter=d.delimiter(ee),E.meta.delimiter=d.delimiter):((k=((F,G,I,P,A)=>{var J,B,oe,pe;A=A||[",","	","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var ge=0;ge<A.length;ge++){for(var he,le=A[ge],ce=0,ye=0,ne=0,se=(oe=void 0,new q({comments:P,delimiter:le,newline:G,preview:10}).parse(F)),ke=0;ke<se.data.length;ke++)I&&X(se.data[ke])?ne++:(he=se.data[ke].length,ye+=he,oe===void 0?oe=he:0<he&&(ce+=Math.abs(he-oe),oe=he));0<se.data.length&&(ye/=se.data.length-ne),(B===void 0||ce<=B)&&(pe===void 0||pe<ye)&&1.99<ye&&(B=ce,J=le,pe=ye)}return{successful:!!(d.delimiter=J),bestDelimiter:J}})(ee,d.newline,d.skipEmptyLines,d.comments,d.delimitersToGuess)).successful?d.delimiter=k.bestDelimiter:(w=!0,d.delimiter=s.DefaultDelimiter),E.meta.delimiter=d.delimiter),U(d));return d.preview&&d.header&&k.preview++,m=ee,y=new q(k),E=y.parse(m,x,b),O(),L?{meta:{paused:!0}}:E||{meta:{paused:!1}}},this.paused=function(){return L},this.pause=function(){L=!0,y.abort(),m=Z(d.chunk)?"":m.substring(y.getCharIndex())},this.resume=function(){N.streamer._halted?(L=!1,N.streamer.parseChunk(m,!0)):setTimeout(N.resume,3)},this.aborted=function(){return C},this.abort=function(){C=!0,y.abort(),E.meta.aborted=!0,Z(d.complete)&&d.complete(E),m=""},this.guessLineEndings=function(F,k){F=F.substring(0,1048576);var k=new RegExp(R(k)+"([^]*?)"+R(k),"gm"),b=(F=F.replace(k,"")).split("\r"),k=F.split(`
`),F=1<k.length&&k[0].length<b[0].length;if(b.length===1||F)return`
`;for(var G=0,I=0;I<b.length;I++)b[I][0]===`
`&&G++;return G>=b.length/2?`\r
`:"\r"}}function R(d){return d.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function q(d){var m=(d=d||{}).delimiter,y=d.newline,w=d.comments,g=d.step,M=d.preview,Y=d.fastMode,te=null,K=!1,N=d.quoteChar==null?'"':d.quoteChar,j=N;if(d.escapeChar!==void 0&&(j=d.escapeChar),(typeof m!="string"||-1<s.BAD_DELIMITERS.indexOf(m))&&(m=","),w===m)throw new Error("Comment character same as delimiter");w===!0?w="#":(typeof w!="string"||-1<s.BAD_DELIMITERS.indexOf(w))&&(w=!1),y!==`
`&&y!=="\r"&&y!==`\r
`&&(y=`
`);var T=0,L=!1;this.parse=function(C,D,E){if(typeof C!="string")throw new Error("Input must be a string");var X=C.length,O=m.length,re=y.length,be=w.length,ee=Z(g),x=[],b=[],k=[],F=T=0;if(!C)return ce();if(Y||Y!==!1&&C.indexOf(N)===-1){for(var G=C.split(y),I=0;I<G.length;I++){if(k=G[I],T+=k.length,I!==G.length-1)T+=y.length;else if(E)return ce();if(!w||k.substring(0,be)!==w){if(ee){if(x=[],pe(k.split(m)),ye(),L)return ce()}else pe(k.split(m));if(M&&M<=I)return x=x.slice(0,M),ce(!0)}}return ce()}for(var P=C.indexOf(m,T),A=C.indexOf(y,T),J=new RegExp(R(j)+R(N),"g"),B=C.indexOf(N,T);;)if(C[T]===N)for(B=T,T++;;){if((B=C.indexOf(N,B+1))===-1)return E||b.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:x.length,index:T}),he();if(B===X-1)return he(C.substring(T,B).replace(J,N));if(N===j&&C[B+1]===j)B++;else if(N===j||B===0||C[B-1]!==j){P!==-1&&P<B+1&&(P=C.indexOf(m,B+1));var oe=ge((A=A!==-1&&A<B+1?C.indexOf(y,B+1):A)===-1?P:Math.min(P,A));if(C.substr(B+1+oe,O)===m){k.push(C.substring(T,B).replace(J,N)),C[T=B+1+oe+O]!==N&&(B=C.indexOf(N,T)),P=C.indexOf(m,T),A=C.indexOf(y,T);break}if(oe=ge(A),C.substring(B+1+oe,B+1+oe+re)===y){if(k.push(C.substring(T,B).replace(J,N)),le(B+1+oe+re),P=C.indexOf(m,T),B=C.indexOf(N,T),ee&&(ye(),L))return ce();if(M&&x.length>=M)return ce(!0);break}b.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:x.length,index:T}),B++}}else if(w&&k.length===0&&C.substring(T,T+be)===w){if(A===-1)return ce();T=A+re,A=C.indexOf(y,T),P=C.indexOf(m,T)}else if(P!==-1&&(P<A||A===-1))k.push(C.substring(T,P)),T=P+O,P=C.indexOf(m,T);else{if(A===-1)break;if(k.push(C.substring(T,A)),le(A+re),ee&&(ye(),L))return ce();if(M&&x.length>=M)return ce(!0)}return he();function pe(ne){x.push(ne),F=T}function ge(ne){var se=0;return se=ne!==-1&&(ne=C.substring(B+1,ne))&&ne.trim()===""?ne.length:se}function he(ne){return E||(ne===void 0&&(ne=C.substring(T)),k.push(ne),T=X,pe(k),ee&&ye()),ce()}function le(ne){T=ne,pe(k),k=[],A=C.indexOf(y,T)}function ce(ne){if(d.header&&!D&&x.length&&!K){var se=x[0],ke=Object.create(null),ue=new Set(se);let qe=!1;for(let Fe=0;Fe<se.length;Fe++){let Me=se[Fe];if(ke[Me=Z(d.transformHeader)?d.transformHeader(Me,Fe):Me]){let Be,Se=ke[Me];for(;Be=Me+"_"+Se,Se++,ue.has(Be););ue.add(Be),se[Fe]=Be,ke[Me]++,qe=!0,(te=te===null?{}:te)[Be]=Me}else ke[Me]=1,se[Fe]=Me;ue.add(Me)}qe&&console.warn("Duplicate headers found and renamed."),K=!0}return{data:x,errors:b,meta:{delimiter:m,linebreak:y,aborted:L,truncated:!!ne,cursor:F+(D||0),renamedHeaders:te}}}function ye(){g(ce()),x=[],b=[]}},this.abort=function(){L=!0},this.getCharIndex=function(){return T}}function Q(d){var m=d.data,y=l[m.workerId],w=!1;if(m.error)y.userError(m.error,m.file);else if(m.results&&m.results.data){var g={abort:function(){w=!0,V(m.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:z,resume:z};if(Z(y.userStep)){for(var M=0;M<m.results.data.length&&(y.userStep({data:m.results.data[M],errors:m.results.errors,meta:m.results.meta},g),!w);M++);delete m.results}else Z(y.userChunk)&&(y.userChunk(m.results,g,m.file),delete m.results)}m.finished&&!w&&V(m.workerId,m.results)}function V(d,m){var y=l[d];Z(y.userComplete)&&y.userComplete(m),y.terminate(),delete l[d]}function z(){throw new Error("Not implemented.")}function U(d){if(typeof d!="object"||d===null)return d;var m,y=Array.isArray(d)?[]:{};for(m in d)y[m]=U(d[m]);return y}function me(d,m){return function(){d.apply(m,arguments)}}function Z(d){return typeof d=="function"}return s.parse=function(d,m){var y=(m=m||{}).dynamicTyping||!1;if(Z(y)&&(m.dynamicTypingFunction=y,y={}),m.dynamicTyping=y,m.transform=!!Z(m.transform)&&m.transform,!m.worker||!s.WORKERS_SUPPORTED)return y=null,s.NODE_STREAM_INPUT,typeof d=="string"?(d=(w=>w.charCodeAt(0)!==65279?w:w.slice(1))(d),y=new(m.download?p:v)(m)):d.readable===!0&&Z(d.read)&&Z(d.on)?y=new _(m):(r.File&&d instanceof File||d instanceof Object)&&(y=new h(m)),y.stream(d);(y=(()=>{var w;return!!s.WORKERS_SUPPORTED&&(w=(()=>{var g=r.URL||r.webkitURL||null,M=n.toString();return s.BLOB_URL||(s.BLOB_URL=g.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",M,")();"],{type:"text/javascript"})))})(),(w=new r.Worker(w)).onmessage=Q,w.id=c++,l[w.id]=w)})()).userStep=m.step,y.userChunk=m.chunk,y.userComplete=m.complete,y.userError=m.error,m.step=Z(m.step),m.chunk=Z(m.chunk),m.complete=Z(m.complete),m.error=Z(m.error),delete m.worker,y.postMessage({input:d,config:m,workerId:y.id})},s.unparse=function(d,m){var y=!1,w=!0,g=",",M=`\r
`,Y='"',te=Y+Y,K=!1,N=null,j=!1,T=((()=>{if(typeof m=="object"){if(typeof m.delimiter!="string"||s.BAD_DELIMITERS.filter(function(D){return m.delimiter.indexOf(D)!==-1}).length||(g=m.delimiter),typeof m.quotes!="boolean"&&typeof m.quotes!="function"&&!Array.isArray(m.quotes)||(y=m.quotes),typeof m.skipEmptyLines!="boolean"&&typeof m.skipEmptyLines!="string"||(K=m.skipEmptyLines),typeof m.newline=="string"&&(M=m.newline),typeof m.quoteChar=="string"&&(Y=m.quoteChar),typeof m.header=="boolean"&&(w=m.header),Array.isArray(m.columns)){if(m.columns.length===0)throw new Error("Option columns is empty");N=m.columns}m.escapeChar!==void 0&&(te=m.escapeChar+Y),m.escapeFormulae instanceof RegExp?j=m.escapeFormulae:typeof m.escapeFormulae=="boolean"&&m.escapeFormulae&&(j=/^[=+\-@\t\r].*$/)}})(),new RegExp(R(Y),"g"));if(typeof d=="string"&&(d=JSON.parse(d)),Array.isArray(d)){if(!d.length||Array.isArray(d[0]))return L(null,d,K);if(typeof d[0]=="object")return L(N||Object.keys(d[0]),d,K)}else if(typeof d=="object")return typeof d.data=="string"&&(d.data=JSON.parse(d.data)),Array.isArray(d.data)&&(d.fields||(d.fields=d.meta&&d.meta.fields||N),d.fields||(d.fields=Array.isArray(d.data[0])?d.fields:typeof d.data[0]=="object"?Object.keys(d.data[0]):[]),Array.isArray(d.data[0])||typeof d.data[0]=="object"||(d.data=[d.data])),L(d.fields||[],d.data||[],K);throw new Error("Unable to serialize unrecognized input");function L(D,E,X){var O="",re=(typeof D=="string"&&(D=JSON.parse(D)),typeof E=="string"&&(E=JSON.parse(E)),Array.isArray(D)&&0<D.length),be=!Array.isArray(E[0]);if(re&&w){for(var ee=0;ee<D.length;ee++)0<ee&&(O+=g),O+=C(D[ee],ee);0<E.length&&(O+=M)}for(var x=0;x<E.length;x++){var b=(re?D:E[x]).length,k=!1,F=re?Object.keys(E[x]).length===0:E[x].length===0;if(X&&!re&&(k=X==="greedy"?E[x].join("").trim()==="":E[x].length===1&&E[x][0].length===0),X==="greedy"&&re){for(var G=[],I=0;I<b;I++){var P=be?D[I]:I;G.push(E[x][P])}k=G.join("").trim()===""}if(!k){for(var A=0;A<b;A++){0<A&&!F&&(O+=g);var J=re&&be?D[A]:A;O+=C(E[x][J],A)}x<E.length-1&&(!X||0<b&&!F)&&(O+=M)}}return O}function C(D,E){var X,O;return D==null?"":D.constructor===Date?JSON.stringify(D).slice(1,25):(O=!1,j&&typeof D=="string"&&j.test(D)&&(D="'"+D,O=!0),X=D.toString().replace(T,te),(O=O||y===!0||typeof y=="function"&&y(D,E)||Array.isArray(y)&&y[E]||((re,be)=>{for(var ee=0;ee<be.length;ee++)if(-1<re.indexOf(be[ee]))return!0;return!1})(X,s.BAD_DELIMITERS)||-1<X.indexOf(g)||X.charAt(0)===" "||X.charAt(X.length-1)===" ")?Y+X+Y:X)}},s.RECORD_SEP="",s.UNIT_SEP="",s.BYTE_ORDER_MARK="\uFEFF",s.BAD_DELIMITERS=["\r",`
`,'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!a&&!!r.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=10485760,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=q,s.ParserHandle=S,s.NetworkStreamer=p,s.FileStreamer=h,s.StringStreamer=v,s.ReadableStreamStreamer=_,r.jQuery&&((i=r.jQuery).fn.parse=function(d){var m=d.config||{},y=[];return this.each(function(M){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var Y=0;Y<this.files.length;Y++)y.push({file:this.files[Y],inputElem:this,instanceConfig:i.extend({},m)})}),w(),this;function w(){if(y.length===0)Z(d.complete)&&d.complete();else{var M,Y,te,K,N=y[0];if(Z(d.before)){var j=d.before(N.file,N.inputElem);if(typeof j=="object"){if(j.action==="abort")return M="AbortError",Y=N.file,te=N.inputElem,K=j.reason,void(Z(d.error)&&d.error({name:M},Y,te,K));if(j.action==="skip")return void g();typeof j.config=="object"&&(N.instanceConfig=i.extend(N.instanceConfig,j.config))}else if(j==="skip")return void g()}var T=N.instanceConfig.complete;N.instanceConfig.complete=function(L){Z(T)&&T(L,N.file,N.inputElem),g()},s.parse(N.file,N.instanceConfig)}}function g(){y.splice(0,1),w()}}),o&&(r.onmessage=function(d){d=d.data,s.WORKER_ID===void 0&&d&&(s.WORKER_ID=d.workerId),typeof d.input=="string"?r.postMessage({workerId:s.WORKER_ID,results:s.parse(d.input,d.config),finished:!0}):(r.File&&d.input instanceof File||d.input instanceof Object)&&(d=s.parse(d.input,d.config))&&r.postMessage({workerId:s.WORKER_ID,results:d,finished:!0})}),(p.prototype=Object.create(f.prototype)).constructor=p,(h.prototype=Object.create(f.prototype)).constructor=h,(v.prototype=Object.create(v.prototype)).constructor=v,(_.prototype=Object.create(f.prototype)).constructor=_,s})}(bn)),bn.exports}var po=ho();const mo=uo(po);async function Ur(e){const t=cr[e];if(!t)throw new Error(`Unknown dataset: ${e}`);const n="./",r=n.endsWith("/")?n:n+"/",i=t.filename.startsWith("/")?t.filename.slice(1):t.filename,a=`${r}${i}`;try{const o=await fetch(a);if(!o.ok)throw new Error(`Failed to load CSV: ${o.status} ${o.statusText}`);const l=await o.text(),c=mo.parse(l,{header:!0,dynamicTyping:!0,skipEmptyLines:!0});return c.errors.length>0&&console.warn("CSV parsing warnings:",c.errors),c.data}catch(o){throw console.error("Error loading data:",o),console.error("Dataset key:",e),console.error("Filename:",t==null?void 0:t.filename),console.error("Full URL:",a),o}}function qr(e){return e.map((t,n)=>({...t,id:String(t["Household ID"]||n),householdId:t["Household ID"],isAnnotated:!1,sectionIndex:null}))}async function go(){try{const[e,t]=await Promise.all([Ur("tcja-expiration"),Ur("tcja-extension")]);return{"tcja-expiration":qr(e),"tcja-extension":qr(t)}}catch(e){throw console.error("Failed to load datasets:",e),new Error("Failed to load datasets")}}function Ni(){if(typeof window<"u"&&window.parent!==window){const e=new URLSearchParams(window.location.search);window.parent.postMessage({type:"urlUpdate",params:e.toString()},"*")}}function Wr(e,t){if(typeof window<"u"){const n=new URL(window.location);e?(n.searchParams.set("household",String(e)),n.searchParams.set("baseline",t)):(n.searchParams.delete("household"),n.searchParams.delete("baseline")),Wa(n.pathname+n.search,{replaceState:!0,noScroll:!0}),Ni()}}function vo(){if(typeof window<"u"){const e=new URLSearchParams(window.location.search);return{householdId:e.get("household")||"",baseline:e.get("baseline")||null,section:e.get("section")||null}}return{householdId:"",baseline:null,section:null}}function _o(e,t){var i;let n=0;const r=e["Market Income"]||e["Gross Income"]||0;return console.log("Finding section for household with income:",r),r<5e4?n=t.findIndex(a=>a.id==="lower-income"):r<2e5?n=t.findIndex(a=>a.id==="middle-income"):r<1e6?n=t.findIndex(a=>a.id==="upper-income"):n=t.findIndex(a=>a.id==="highest-income"),console.log("Target section index:",n,"for section:",(i=t[n])==null?void 0:i.id),Math.max(0,n)}const Pt=Vt(0),Si=Vt(0),kn=Vt(!1),Zn=Vt(0),ur=Vt(0);let Vr=null,yo=1200,Ft=null;function wo(e,t){const n={root:null,rootMargin:"-45% 0px -45% 0px",threshold:0},r=new IntersectionObserver(i=>{i.forEach(a=>{if(a.isIntersecting){const o=parseInt(a.target.dataset.index);!isNaN(o)&&o!==Qt(Pt)&&xo(o,t)}})},n);return e.forEach(i=>{i&&r.observe(i)}),r}function xo(e,t){if(Qt(kn)||e===Qt(Pt))return;Si.set(Qt(Pt)),Pt.set(e),kn.set(!0),Zn.set(0),Vr=performance.now(),Ft&&cancelAnimationFrame(Ft);function n(r){const i=r-Vr,a=Math.min(i/yo,1);Zn.set(a),ur.set(bo(a)),a<1?Ft=requestAnimationFrame(n):(kn.set(!1),Zn.set(1),ur.set(1),t&&t(Qt(Pt)))}Ft=requestAnimationFrame(n)}function bo(e){return e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2}function er(e){if(!e.length)return null;const t=e.reduce((i,a)=>{const o=a["Household weight"]||a["Household Weight"]||1;return i+o},0),n=Math.random()*t;let r=0;for(const i of e){const a=i["Household weight"]||i["Household Weight"]||1;if(r+=a,r>=n)return i}return e[e.length-1]}function Yr(e){e&&e.disconnect(),Ft&&cancelAnimationFrame(Ft)}const wt=new Map,Bt=new Map;function tr(e,t,n,r,i=800){wt.has(e)&&clearInterval(wt.get(e));const a=document.getElementById(e);if(!a)return;const o=performance.now();function l(s){const f=s-o,p=Math.min(f/i,1),h=1-Math.pow(1-p,3),v=t+(n-t)*h;if(a.textContent=r(v),p<1){const _=requestAnimationFrame(l);wt.set(e,_)}else wt.delete(e)}const c=requestAnimationFrame(l);wt.set(e,c)}function Gr(e,t=600){const n=Bt.get(e);n!=null&&n.animationId&&cancelAnimationFrame(n.animationId);const r=performance.now(),i={isAnimating:!0,scale:1,opacity:1,animationId:null};Bt.set(e,i);function a(o){const l=o-r,c=Math.min(l/t,1);if(c<.5){const s=c*2;i.scale=1+.5*s,i.opacity=1+.3*s}else{const s=(c-.5)*2;i.scale=1.5-.5*s,i.opacity=1.3-.3*s}c<1?i.animationId=requestAnimationFrame(a):(i.isAnimating=!1,i.scale=1,i.opacity=1,Bt.delete(e))}i.animationId=requestAnimationFrame(a)}function Kr(){wt.forEach(e=>cancelAnimationFrame(e)),wt.clear(),Bt.forEach(e=>{e.animationId&&cancelAnimationFrame(e.animationId)}),Bt.clear()}var ko=xe('<div class="loading-overlay svelte-yblca9"><div class="loading-content svelte-yblca9"><div class="spinner svelte-yblca9"></div> <p class="svelte-yblca9"> </p></div></div>');function Ao(e,t){cn(t,!1);const n=we();let r=Ie(t,"message",8,"Loading data..."),i=Ie(t,"dataset",8,null);kt(()=>(fe(r()),fe(i())),()=>{ae(n,r()||(i()?`Loading ${i().label} data...`:"Loading data..."))}),Bn(),ln();var a=ko(),o=H(a),l=ie(H(o),2),c=H(l,!0);$(l),$(o),$(a),Ne(()=>_e(c,u(n))),de(e,a),un()}var Eo=xe("<button> </button>"),Io=xe('<header class="floating-header svelte-z3h7qd"><div class="header-content svelte-z3h7qd"><h1 class="app-title svelte-z3h7qd">OBBBA Household Explorer</h1> <div class="baseline-selector-container svelte-z3h7qd"><span class="baseline-label svelte-z3h7qd">Baseline:</span> <div class="baseline-selector svelte-z3h7qd"></div></div></div></header>');function Mo(e,t){cn(t,!1);let n=Ie(t,"selectedDataset",8,"tcja-expiration"),r=Ie(t,"loading",8,!1),i=Ie(t,"onDatasetChange",8,()=>{}),a=we(),o=!1;kr(()=>{if(o=window.self!==window.top,o&&u(a)){const p=()=>{u(a)&&(Ge(a,u(a).style.position="fixed"),Ge(a,u(a).style.top="0"),Ge(a,u(a).style.transform="translateY(0)"))};return window.addEventListener("scroll",p,!0),window.addEventListener("resize",p),p(),()=>{window.removeEventListener("scroll",p,!0),window.removeEventListener("resize",p)}}}),ln();var l=Io(),c=H(l),s=ie(H(c),2),f=ie(H(s),2);Nn(f,5,()=>(fe(cr),W(()=>Object.entries(cr))),Cn,(p,h)=>{var v=Ba(()=>za(u(h),2));let _=()=>u(v)[0],S=()=>u(v)[1];var R=Eo();let q;var Q=H(R,!0);$(R),Ne(V=>{q=Ot(R,1,"tab-button svelte-z3h7qd",null,q,V),R.disabled=r(),_e(Q,(S(),W(()=>S().label)))},[()=>({active:n()===_()})],Xe),ut("click",R,()=>i()(_())),de(p,R)}),$(f),$(s),$(c),$(l),At(l,p=>ae(a,p),()=>u(a)),de(e,l),un()}const Ti=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}),Co=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:1,maximumFractionDigits:1});function Ze(e){return e==null||isNaN(e)?"$0":Ti.format(e)}function Xr(e){if(!e||e===0)return"0.0%";const t=Co.format(e/100);return e>0?"+"+t:t}function pn(e){if(e==null||e===0)return"$0";const t=Ti.format(Math.abs(e));return e>0?"+"+t:"-"+t}function mn(e="sans"){const t={serif:"'Roboto Serif', serif",sans:"system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",mono:"'Menlo', 'Monaco', 'Courier New', monospace"};return t[e]||t.sans}async function No(e,t,n,r){r&&r.preventDefault&&r.preventDefault();let i;const a=typeof window<"u"&&window.parent!==window;console.log("Copy URL debug:",{isInIframe:a,currentLocation:window.location.href,household:e.id,baseline:t,section:n==null?void 0:n.id}),a?i=new URL("https://policyengine.org/us/obbba-household-explorer"):i=new URL(window.location.href),i.searchParams.set("household",e.id),i.searchParams.set("baseline",t);const o=i.toString();console.log("Full URL to copy:",o);try{if(await navigator.clipboard.writeText(o),console.log("Successfully copied URL to clipboard"),r&&r.target){const l=r.target.closest("button");if(l){const c=l.title;l.title="Copied!",l.classList.add("copied"),setTimeout(()=>{l.title=c,l.classList.remove("copied")},2e3)}}return!0}catch(l){console.error("Clipboard API failed:",l);try{const c=document.createElement("textarea");c.value=o,c.style.position="fixed",c.style.left="-999999px",c.style.top="-999999px",document.body.appendChild(c),c.focus(),c.select();const s=document.execCommand("copy");if(document.body.removeChild(c),s){if(console.log("Successfully copied using execCommand fallback"),r&&r.target){const f=r.target.closest("button");if(f){const p=f.title;f.title="Copied!",f.classList.add("copied"),setTimeout(()=>{f.title=p,f.classList.remove("copied")},2e3)}}return!0}else return console.error("execCommand copy failed"),alert("Failed to copy URL. URL is: "+o),!1}catch(c){return console.error("All copy methods failed:",c),alert("Failed to copy URL. URL is: "+o),!1}}}function jr(e){return Object.prototype.toString.call(e)==="[object Date]"}function So(e){return e}function Rt(e){const t=e-1;return t*t*t+1}function fr(e,t){if(e===t||e!==e)return()=>e;const n=typeof e;if(n!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const r=t.map((i,a)=>fr(e[a],i));return i=>r.map(a=>a(i))}if(n==="object"){if(!e||!t)throw new Error("Object cannot be null");if(jr(e)&&jr(t)){const a=e.getTime(),l=t.getTime()-a;return c=>new Date(a+c*l)}const r=Object.keys(t),i={};return r.forEach(a=>{i[a]=fr(e[a],t[a])}),a=>{const o={};return r.forEach(l=>{o[l]=i[l](a)}),o}}if(n==="number"){const r=t-e;return i=>e+i*r}return()=>t}function Dt(e,t={}){const n=Vt(e);let r,i=e;function a(o,l){if(i=o,e==null)return n.set(e=o),Promise.resolve();let c=r,s=!1,{delay:f=0,duration:p=400,easing:h=So,interpolate:v=fr}={...t,...l};if(p===0)return c&&(c.abort(),c=null),n.set(e=i),Promise.resolve();const _=tt.now()+f;let S;return r=to(R=>{if(R<_)return!0;s||(S=v(e,o),typeof p=="function"&&(p=p(e,o)),s=!0),c&&(c.abort(),c=null);const q=R-_;return q>p?(n.set(e=o),!1):(n.set(e=S(h(q/p))),!0)}),r.promise}return{set:a,update:(o,l)=>a(o(i,e),l),subscribe:n.subscribe}}var To=xe('<div class="detail-item svelte-10ulfop"><span class="label svelte-10ulfop">Baseline net income:</span> <span class="value svelte-10ulfop"> </span></div>'),Ro=xe('<div class="detail-item svelte-10ulfop"><span class="label svelte-10ulfop"> </span> <span class="value svelte-10ulfop"><!></span></div>'),Do=xe('<div class="expandable-details svelte-10ulfop"><div class="detail-item svelte-10ulfop"><span class="label svelte-10ulfop">Filing status:</span> <span class="value svelte-10ulfop"> </span></div> <!> <!></div>'),Lo=xe('<div class="detail-item svelte-10ulfop"><span class="label svelte-10ulfop"> </span> <span> </span></div>'),Oo=xe('<p class="no-provisions svelte-10ulfop">No significant provision changes for this household.</p>'),Po=xe('<div class="expandable-details provision-details svelte-10ulfop"><!></div>'),Fo=xe('<div><h3 class="svelte-10ulfop"> <div class="header-buttons svelte-10ulfop"><button class="action-button random-button svelte-10ulfop" title="Pick a new random household">ð</button> <button class="action-button link-button svelte-10ulfop" title="Copy link to this household">ð</button></div></h3> <div class="household-section svelte-10ulfop"><div class="household-basics svelte-10ulfop"><div class="detail-item svelte-10ulfop"><span class="label svelte-10ulfop">State:</span> <span class="value svelte-10ulfop"> </span></div> <div class="detail-item svelte-10ulfop"><span class="label svelte-10ulfop">Ages:</span> <span class="value svelte-10ulfop"> </span></div> <div class="detail-item svelte-10ulfop"><span class="label svelte-10ulfop">Market income:</span> <span class="value svelte-10ulfop"> </span></div> <button class="expand-button svelte-10ulfop"><span class="expand-icon svelte-10ulfop"> </span> </button></div> <!></div> <div class="impact-section svelte-10ulfop"><h4 class="svelte-10ulfop">OBBBA impact</h4> <div class="impact-details svelte-10ulfop"><div class="detail-item svelte-10ulfop"><span class="label svelte-10ulfop"> </span> <span class="value svelte-10ulfop"> </span></div> <div class="detail-item svelte-10ulfop"><span class="label svelte-10ulfop">Net income under OBBBA:</span> <span class="value svelte-10ulfop"> </span></div> <div class="detail-item svelte-10ulfop"><span class="label svelte-10ulfop">OBBBA absolute impact:</span> <span> </span></div> <div class="detail-item svelte-10ulfop"><span class="label svelte-10ulfop">OBBBA relative impact:</span> <span> </span></div> <button class="expand-button svelte-10ulfop"><span class="expand-icon svelte-10ulfop"> </span> </button></div></div> <!></div>');function $o(e,t){cn(t,!1);const[n,r]=Ei(),i=()=>et(U,"$householdId",n),a=()=>et(me,"$marketIncome",n),o=()=>et(Z,"$baselineNetIncome",n),l=()=>et(d,"$obbbaNetIncome",n),c=()=>et(m,"$absoluteImpact",n),s=()=>et(y,"$relativeImpact",n),f=we();function p(L,C){return D=>{if(D<.7){const E=L+(C-L)*D,X=(Math.random()-.5)*Math.abs(C-L)*.5;return E+X}return L+(C-L)*D}}let h=Ie(t,"household",8,null),v=Ie(t,"selectedDataset",8,"tcja-expiration"),_=Ie(t,"currentState",8,null);Ie(t,"sectionIndex",8,0);let S=Ie(t,"onRandomize",8,()=>{}),R=we(!1),q=we(!1),Q=we(!1),V=we(null),z=we(null);const U=Dt(0,{duration:600,easing:Rt,interpolate:p}),me=Dt(0,{duration:700,easing:Rt,interpolate:p}),Z=Dt(0,{duration:750,easing:Rt,interpolate:p}),d=Dt(0,{duration:800,easing:Rt,interpolate:p}),m=Dt(0,{duration:850,easing:Rt,interpolate:p}),y=Dt(0,{duration:900,easing:Rt,interpolate:p});let w=we(null),g=we(null);const M={AL:"Alabama",AK:"Alaska",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",FL:"Florida",GA:"Georgia",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"};function Y(L){if(!L)return"";const C=[],D=L["Age of Head"]||L.Age;D&&C.push(Math.round(D)),L["Is Married"]&&L["Age of Spouse"]&&C.push(Math.round(L["Age of Spouse"]));const E=Math.round(L["Number of Dependents"]||L.Dependents||0);if(E>0)for(let X=1;X<=E;X++){const O=L[`Age of Dependent ${X}`];O&&O>0&&C.push(Math.round(O))}return C.sort((X,O)=>O-X),C.join(", ")}function te(L){if(!L)return[];const C=["id","isAnnotated","sectionIndex","isHighlighted","highlightGroup","stateIndex","householdId"],D=[];Object.entries(L).forEach(([O,re])=>{if(!C.includes(O)&&re!==0&&re!=="0"&&re)if(O.includes(" after ")){const be=O.match(/after (.+)$/),ee=be?be[1]:O;D.push({key:O,value:re,type:"provision",reformName:ee})}else D.push({key:O,value:re,type:"basic"})});const X=D.filter(O=>O.type==="provision"&&O.key.includes("Net income")).sort((O,re)=>Math.abs(re.value)-Math.abs(O.value));return{basic:D.filter(O=>O.type==="basic"),provisions:X}}function K(L){return L?[{name:"Rate Adjustment",key:"Change in Net income after Rate Adjustments"},{name:"Standard Deduction Increase",key:"Change in Net income after Standard deduction increase"},{name:"Exemption Repeal",key:"Change in Net income after Exemption Reform"},{name:"Child Tax Credit Social Security Number Requirement",key:"Change in Net income after Child Tax Credit Social Security Number Requirement"},{name:"Child Tax Credit Expansion",key:"Change in Net income after Child Tax Credit Expansion"},{name:"Qualified Business Income Deduction Reform",key:"Change in Net income after Qualified Business Interest Deduction Reform"},{name:"Alternative Minimum Tax Reform",key:"Change in Net income after Alternative Minimum Tax Reform"},{name:"Miscellaneous Deductions Reform",key:"Change in Net income after Miscellaneous Deduction Reform"},{name:"Charitable Deductions Reform",key:"Change in Net income after Charitable Deductions Reform"},{name:"Casualty Loss Deductions Repeal",key:"Change in Net income after Casualty Loss Deductions Repeal"},{name:"Pease Repeal",key:"Change in Net income after Pease Repeal"},{name:"Limitation on Itemized Deductions Reform",key:"Change in Net income after Limitation on Itemized Deductions Reform"},{name:"Estate Tax Reform",key:"Change in Net income after Estate Tax Reform"},{name:"New Senior Deduction",key:"Change in Net income after New Senior Deduction"},{name:"Tip Exemption",key:"Change in Net income after Tip Exemption"},{name:"Overtime Exemption",key:"Change in Net income after Overtime Exemption"},{name:"Auto Loan Interest Deduction",key:"Change in Net income after Auto Loan Interest Deduction"},{name:"Cap on State and Local Tax Deduction",key:"Change in Net income after Cap on state and local tax deduction"},{name:"Child and Dependent Care Credit Reform",key:"Change in Net income after Child and dependent care credit reform"},{name:"Extension of ACA Enhanced Subsidies",key:"Change in Net income after Extension of ACA Enhanced Subsidies"},{name:"SNAP Reform",key:"Change in Net income after SNAP Reform"},{name:"Medicaid Reform",key:"Change in Net income after Medicaid Reform"}].map((D,E)=>({name:D.name,value:L[D.key]||0,index:E})).filter(D=>Math.abs(D.value)>.01):[]}kt(()=>(fe(h()),u(w),fe(v()),u(g),u(V),u(Q),i()),()=>{if(h()&&(h().id!==u(w)||v()!==u(g))){if(u(V)&&!u(Q)){const L=u(V).getBoundingClientRect();ae(z,{top:L.top,left:L.left,width:L.width,height:L.height}),ae(Q,!0)}console.log("HouseholdProfile updating:",{householdId:h().id,dataset:v(),netChange:h()["Total Change in Net Income"]||h()["Change in Household Net Income"],percentChange:h()["Percentage Change in Net Income"],baselineNetIncome:h()["Baseline Net Income"],marketIncome:h()["Market Income"]||h()["Gross Income"],allKeys:Object.keys(h()).filter(L=>L.includes("Income")||L.includes("Net"))}),v()!==u(g)&&(ae(R,!1),ae(q,!1)),ae(w,h().id),ae(g,v()),i()===0&&(U.set(Math.random()*4e4,{duration:0}),me.set(Math.random()*2e5,{duration:0}),Z.set(Math.random()*15e4,{duration:0}),d.set(Math.random()*15e4,{duration:0}),m.set((Math.random()-.5)*2e4,{duration:0}),y.set((Math.random()-.5)*20,{duration:0})),U.set(parseInt(h().id)||0),me.set(h()["Market Income"]||h()["Gross Income"]||0),Z.set(h()["Baseline Net Income"]||0),d.set((h()["Baseline Net Income"]||0)+(h()["Total Change in Net Income"]||h()["Change in Household Net Income"]||0)),m.set(h()["Total Change in Net Income"]||h()["Change in Household Net Income"]||0),y.set(h()["Percentage Change in Net Income"]||0),setTimeout(()=>{ae(Q,!1),ae(z,null)},950)}}),kt(()=>fe(h()),()=>{ae(f,h()?K(h()):[])}),Bn(),ln();var N=Lt(),j=mt(N);{var T=L=>{var C=Fo();let D;var E=H(C),X=H(E),O=ie(X),re=H(O),be=ie(re,2);$(O),$(E);var ee=ie(E,2),x=H(ee),b=H(x),k=ie(H(b),2),F=H(k,!0);$(k),$(b);var G=ie(b,2),I=ie(H(G),2),P=H(I,!0);$(I),$(G);var A=ie(G,2),J=ie(H(A),2),B=H(J,!0);$(J),$(A);var oe=ie(A,2),pe=H(oe),ge=H(pe,!0);$(pe);var he=ie(pe);$(oe),$(x);var le=ie(x,2);{var ce=Ee=>{var Ve=Do(),De=H(Ve),ze=ie(H(De),2),ot=H(ze,!0);$(ze),$(De);var Re=ie(De,2);{var Ue=Ye=>{var ve=To(),lt=ie(H(ve),2),vt=H(lt,!0);$(lt),$(ve),Ne(Gt=>_e(vt,Gt),[()=>(fe(Ze),fe(h()),W(()=>Ze(h()["Baseline Net Income"])))],Xe),de(Ye,ve)};Ae(Re,Ye=>{fe(h()),W(()=>h()["Baseline Net Income"])&&Ye(Ue)})}var st=ie(Re,2);Nn(st,1,()=>(fe(h()),W(()=>te(h()).basic)),Cn,(Ye,ve)=>{var lt=Lt(),vt=mt(lt);{var Gt=_t=>{var Nt=Ro(),Kt=H(Nt),Gn=H(Kt);$(Kt);var dn=ie(Kt,2),la=H(dn);{var ca=St=>{var Xt=Lt(),fa=mt(Xt);{var ha=Tt=>{var jt=Jn();Ne(Kn=>_e(jt,Kn),[()=>(fe(Ze),u(ve),W(()=>Ze(u(ve).value)))],Xe),de(Tt,jt)},da=Tt=>{var jt=Jn();Ne(Kn=>_e(jt,Kn),[()=>(u(ve),W(()=>Math.round(u(ve).value).toLocaleString()))],Xe),de(Tt,jt)};Ae(fa,Tt=>{u(ve),W(()=>u(ve).key.includes("Income")||u(ve).key.includes("Taxes")||u(ve).key.includes("Benefits"))?Tt(ha):Tt(da,!1)})}de(St,Xt)},ua=St=>{var Xt=Jn();Ne(()=>_e(Xt,(u(ve),W(()=>u(ve).value)))),de(St,Xt)};Ae(la,St=>{u(ve),W(()=>typeof u(ve).value=="number")?St(ca):St(ua,!1)})}$(dn),$(Nt),Ne(()=>_e(Gn,`${u(ve),W(()=>u(ve).key)??""}:`)),de(_t,Nt)};Ae(vt,_t=>{u(ve),W(()=>!["State","Age of Head","Age","Market Income","Gross Income","Is Married","Number of Dependents","Dependents","Baseline Net Income"].includes(u(ve).key))&&_t(Gt)})}de(Ye,lt)}),$(Ve),Ne(()=>_e(ot,(fe(h()),W(()=>h()["Is Married"]?"Married":"Single")))),de(Ee,Ve)};Ae(le,Ee=>{u(R)&&Ee(ce)})}$(ee);var ye=ie(ee,2),ne=ie(H(ye),2),se=H(ne),ke=H(se),ue=H(ke);$(ke);var qe=ie(ke,2),Fe=H(qe,!0);$(qe),$(se);var Me=ie(se,2),Be=ie(H(Me),2),Se=H(Be,!0);$(Be),$(Me);var Ce=ie(Me,2),Te=ie(H(Ce),2);let ht;var Wn=H(Te,!0);$(Te),$(Ce);var Qe=ie(Ce,2),it=ie(H(Qe),2);let Ct;var Vn=H(it,!0);$(it),$(Qe);var We=ie(Qe,2),at=H(We),Yt=H(at,!0);$(at);var Yn=ie(at);$(We),$(ne),$(ye);var dt=ie(ye,2);{var gt=Ee=>{var Ve=Po(),De=H(Ve);{var ze=Re=>{var Ue=Lt(),st=mt(Ue);Nn(st,1,()=>u(f),Cn,(Ye,ve)=>{var lt=Lo(),vt=H(lt),Gt=H(vt);$(vt);var _t=ie(vt,2);let Nt;var Kt=H(_t,!0);$(_t),$(lt),Ne((Gn,dn)=>{_e(Gt,`${u(ve),W(()=>u(ve).name)??""}:`),Nt=Ot(_t,1,"value impact svelte-10ulfop",null,Nt,Gn),_e(Kt,dn)},[()=>({pos:u(ve).value>0,neg:u(ve).value<0}),()=>(fe(pn),u(ve),W(()=>pn(u(ve).value)))],Xe),de(Ye,lt)}),de(Re,Ue)},ot=Re=>{var Ue=Oo();de(Re,Ue)};Ae(De,Re=>{u(f),W(()=>u(f).length>0)?Re(ze):Re(ot,!1)})}$(Ve),de(Ee,Ve)};Ae(dt,Ee=>{u(q)&&Ee(gt)})}$(C),At(C,Ee=>ae(V,Ee),()=>u(V)),Ne((Ee,Ve,De,ze,ot,Re,Ue,st,Ye,ve)=>{D=Ot(C,1,"household-profile svelte-10ulfop",null,D,Ee),Mi(C,(u(Q),u(z),W(()=>u(Q)&&u(z)?`
      position: fixed !important;
      top: ${u(z).top}px !important;
      left: ${u(z).left}px !important;
      width: ${u(z).width}px !important;
      z-index: 1000;
    `:""))),_e(X,`Household #${Ve??""} `),_e(F,(fe(h()),W(()=>M[h().State]||h().State||"N/A"))),_e(P,De),_e(B,ze),lr(oe,"title",`${u(R)?"Hide":"Show"} more household details`),_e(ge,u(R)?"â":"+"),_e(he,` ${u(R)?"Show less":"Show more"}`),_e(ue,`Net income under TCJA ${v()==="tcja-expiration"?"expiration":"extension"}:`),_e(Fe,ot),_e(Se,Re),ht=Ot(Te,1,"value impact svelte-10ulfop",null,ht,Ue),_e(Wn,st),Ct=Ot(it,1,"value impact svelte-10ulfop",null,Ct,Ye),_e(Vn,ve),lr(We,"title",`${u(q)?"Hide":"Show"} provision breakdown`),_e(Yt,u(q)?"â":"+"),_e(Yn,` ${u(q)?"Hide provisions":"Show provisions"}`)},[()=>({transitioning:u(Q)}),()=>(i(),W(()=>Math.round(i()))),()=>(fe(h()),W(()=>Y(h()))),()=>(fe(Ze),a(),W(()=>Ze(a()))),()=>(fe(Ze),o(),W(()=>Ze(o()))),()=>(fe(Ze),l(),W(()=>Ze(l()))),()=>({pos:c()>0,neg:c()<0}),()=>(fe(pn),c(),W(()=>pn(c()))),()=>({pos:s()>0,neg:s()<0}),()=>(fe(Xr),s(),W(()=>Xr(s())))],Xe),ut("click",re,io(ro(Ee=>{Ee.preventDefault(),Ee.stopPropagation(),Ee.currentTarget.blur(),S()()}))),ut("click",be,Ee=>No(h(),v(),_(),Ee)),ut("click",oe,()=>ae(R,!u(R))),ut("click",We,()=>ae(q,!u(q))),de(L,C)};Ae(j,L=>{h()&&L(T)})}de(e,N),un(),r()}function An(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ho(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ri(e){let t,n,r;e.length!==2?(t=An,n=(l,c)=>An(e(l),c),r=(l,c)=>e(l)-c):(t=e===An||e===Ho?e:Bo,n=e,r=e);function i(l,c,s=0,f=l.length){if(s<f){if(t(c,c)!==0)return f;do{const p=s+f>>>1;n(l[p],c)<0?s=p+1:f=p}while(s<f)}return s}function a(l,c,s=0,f=l.length){if(s<f){if(t(c,c)!==0)return f;do{const p=s+f>>>1;n(l[p],c)<=0?s=p+1:f=p}while(s<f)}return s}function o(l,c,s=0,f=l.length){const p=i(l,c,s,f-1);return p>s&&r(l[p-1],c)>-r(l[p],c)?p-1:p}return{left:i,center:o,right:a}}function Bo(){return 0}function zo(e){return e===null?NaN:+e}const Uo=Ri(An),qo=Uo.right;Ri(zo).center;const Wo=Math.sqrt(50),Vo=Math.sqrt(10),Yo=Math.sqrt(2);function Sn(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=Wo?10:a>=Vo?5:a>=Yo?2:1;let l,c,s;return i<0?(s=Math.pow(10,-i)/o,l=Math.round(e*s),c=Math.round(t*s),l/s<e&&++l,c/s>t&&--c,s=-s):(s=Math.pow(10,i)*o,l=Math.round(e/s),c=Math.round(t/s),l*s<e&&++l,c*s>t&&--c),c<l&&.5<=n&&n<2?Sn(e,t,n*2):[l,c,s]}function Go(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,a,o]=r?Sn(t,e,n):Sn(e,t,n);if(!(a>=i))return[];const l=a-i+1,c=new Array(l);if(r)if(o<0)for(let s=0;s<l;++s)c[s]=(a-s)/-o;else for(let s=0;s<l;++s)c[s]=(a-s)*o;else if(o<0)for(let s=0;s<l;++s)c[s]=(i+s)/-o;else for(let s=0;s<l;++s)c[s]=(i+s)*o;return c}function hr(e,t,n){return t=+t,e=+e,n=+n,Sn(e,t,n)[2]}function Ko(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?hr(t,e,n):hr(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function Xo(e){return e}var nr=1,rr=2,dr=3,en=4,Jr=1e-6;function jo(e){return"translate("+e+",0)"}function Jo(e){return"translate(0,"+e+")"}function Qo(e){return t=>+e(t)}function Zo(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function es(){return!this.__axis}function Di(e,t){var n=[],r=null,i=null,a=6,o=6,l=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,s=e===nr||e===en?-1:1,f=e===en||e===rr?"x":"y",p=e===nr||e===dr?jo:Jo;function h(v){var _=r??(t.ticks?t.ticks.apply(t,n):t.domain()),S=i??(t.tickFormat?t.tickFormat.apply(t,n):Xo),R=Math.max(a,0)+l,q=t.range(),Q=+q[0]+c,V=+q[q.length-1]+c,z=(t.bandwidth?Zo:Qo)(t.copy(),c),U=v.selection?v.selection():v,me=U.selectAll(".domain").data([null]),Z=U.selectAll(".tick").data(_,t).order(),d=Z.exit(),m=Z.enter().append("g").attr("class","tick"),y=Z.select("line"),w=Z.select("text");me=me.merge(me.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),Z=Z.merge(m),y=y.merge(m.append("line").attr("stroke","currentColor").attr(f+"2",s*a)),w=w.merge(m.append("text").attr("fill","currentColor").attr(f,s*R).attr("dy",e===nr?"0em":e===dr?"0.71em":"0.32em")),v!==U&&(me=me.transition(v),Z=Z.transition(v),y=y.transition(v),w=w.transition(v),d=d.transition(v).attr("opacity",Jr).attr("transform",function(g){return isFinite(g=z(g))?p(g+c):this.getAttribute("transform")}),m.attr("opacity",Jr).attr("transform",function(g){var M=this.parentNode.__axis;return p((M&&isFinite(M=M(g))?M:z(g))+c)})),d.remove(),me.attr("d",e===en||e===rr?o?"M"+s*o+","+Q+"H"+c+"V"+V+"H"+s*o:"M"+c+","+Q+"V"+V:o?"M"+Q+","+s*o+"V"+c+"H"+V+"V"+s*o:"M"+Q+","+c+"H"+V),Z.attr("opacity",1).attr("transform",function(g){return p(z(g)+c)}),y.attr(f+"2",s*a),w.attr(f,s*R).text(S),U.filter(es).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===rr?"start":e===en?"end":"middle"),U.each(function(){this.__axis=z})}return h.scale=function(v){return arguments.length?(t=v,h):t},h.ticks=function(){return n=Array.from(arguments),h},h.tickArguments=function(v){return arguments.length?(n=v==null?[]:Array.from(v),h):n.slice()},h.tickValues=function(v){return arguments.length?(r=v==null?null:Array.from(v),h):r&&r.slice()},h.tickFormat=function(v){return arguments.length?(i=v,h):i},h.tickSize=function(v){return arguments.length?(a=o=+v,h):a},h.tickSizeInner=function(v){return arguments.length?(a=+v,h):a},h.tickSizeOuter=function(v){return arguments.length?(o=+v,h):o},h.tickPadding=function(v){return arguments.length?(l=+v,h):l},h.offset=function(v){return arguments.length?(c=+v,h):c},h}function ts(e){return Di(dr,e)}function ns(e){return Di(en,e)}var rs={value:()=>{}};function Li(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new En(n)}function En(e){this._=e}function is(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}En.prototype=Li.prototype={constructor:En,on:function(e,t){var n=this._,r=is(e+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(e=r[a]).type)&&(i=as(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<o;)if(i=(e=r[a]).type)n[i]=Qr(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Qr(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new En(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function as(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Qr(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=rs,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var pr="http://www.w3.org/1999/xhtml";const Zr={svg:"http://www.w3.org/2000/svg",xhtml:pr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function zn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Zr.hasOwnProperty(t)?{space:Zr[t],local:e}:e}function os(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===pr&&t.documentElement.namespaceURI===pr?t.createElement(e):t.createElementNS(n,e)}}function ss(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Oi(e){var t=zn(e);return(t.local?ss:os)(t)}function ls(){}function Ir(e){return e==null?ls:function(){return this.querySelector(e)}}function cs(e){typeof e!="function"&&(e=Ir(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,l=r[i]=new Array(o),c,s,f=0;f<o;++f)(c=a[f])&&(s=e.call(c,c.__data__,f,a))&&("__data__"in c&&(s.__data__=c.__data__),l[f]=s);return new He(r,this._parents)}function us(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function fs(){return[]}function Pi(e){return e==null?fs:function(){return this.querySelectorAll(e)}}function hs(e){return function(){return us(e.apply(this,arguments))}}function ds(e){typeof e=="function"?e=hs(e):e=Pi(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o=t[a],l=o.length,c,s=0;s<l;++s)(c=o[s])&&(r.push(e.call(c,c.__data__,s,o)),i.push(c));return new He(r,i)}function Fi(e){return function(){return this.matches(e)}}function $i(e){return function(t){return t.matches(e)}}var ps=Array.prototype.find;function ms(e){return function(){return ps.call(this.children,e)}}function gs(){return this.firstElementChild}function vs(e){return this.select(e==null?gs:ms(typeof e=="function"?e:$i(e)))}var _s=Array.prototype.filter;function ys(){return Array.from(this.children)}function ws(e){return function(){return _s.call(this.children,e)}}function xs(e){return this.selectAll(e==null?ys:ws(typeof e=="function"?e:$i(e)))}function bs(e){typeof e!="function"&&(e=Fi(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,l=r[i]=[],c,s=0;s<o;++s)(c=a[s])&&e.call(c,c.__data__,s,a)&&l.push(c);return new He(r,this._parents)}function Hi(e){return new Array(e.length)}function ks(){return new He(this._enter||this._groups.map(Hi),this._parents)}function Tn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Tn.prototype={constructor:Tn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function As(e){return function(){return e}}function Es(e,t,n,r,i,a){for(var o=0,l,c=t.length,s=a.length;o<s;++o)(l=t[o])?(l.__data__=a[o],r[o]=l):n[o]=new Tn(e,a[o]);for(;o<c;++o)(l=t[o])&&(i[o]=l)}function Is(e,t,n,r,i,a,o){var l,c,s=new Map,f=t.length,p=a.length,h=new Array(f),v;for(l=0;l<f;++l)(c=t[l])&&(h[l]=v=o.call(c,c.__data__,l,t)+"",s.has(v)?i[l]=c:s.set(v,c));for(l=0;l<p;++l)v=o.call(e,a[l],l,a)+"",(c=s.get(v))?(r[l]=c,c.__data__=a[l],s.delete(v)):n[l]=new Tn(e,a[l]);for(l=0;l<f;++l)(c=t[l])&&s.get(h[l])===c&&(i[l]=c)}function Ms(e){return e.__data__}function Cs(e,t){if(!arguments.length)return Array.from(this,Ms);var n=t?Is:Es,r=this._parents,i=this._groups;typeof e!="function"&&(e=As(e));for(var a=i.length,o=new Array(a),l=new Array(a),c=new Array(a),s=0;s<a;++s){var f=r[s],p=i[s],h=p.length,v=Ns(e.call(f,f&&f.__data__,s,r)),_=v.length,S=l[s]=new Array(_),R=o[s]=new Array(_),q=c[s]=new Array(h);n(f,p,S,R,q,v,t);for(var Q=0,V=0,z,U;Q<_;++Q)if(z=S[Q]){for(Q>=V&&(V=Q+1);!(U=R[V])&&++V<_;);z._next=U||null}}return o=new He(o,r),o._enter=l,o._exit=c,o}function Ns(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Ss(){return new He(this._exit||this._groups.map(Hi),this._parents)}function Ts(e,t,n){var r=this.enter(),i=this,a=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function Rs(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,a=r.length,o=Math.min(i,a),l=new Array(i),c=0;c<o;++c)for(var s=n[c],f=r[c],p=s.length,h=l[c]=new Array(p),v,_=0;_<p;++_)(v=s[_]||f[_])&&(h[_]=v);for(;c<i;++c)l[c]=n[c];return new He(l,this._parents)}function Ds(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function Ls(e){e||(e=Os);function t(p,h){return p&&h?e(p.__data__,h.__data__):!p-!h}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o=n[a],l=o.length,c=i[a]=new Array(l),s,f=0;f<l;++f)(s=o[f])&&(c[f]=s);c.sort(t)}return new He(i,this._parents).order()}function Os(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ps(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Fs(){return Array.from(this)}function $s(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function Hs(){let e=0;for(const t of this)++e;return e}function Bs(){return!this.node()}function zs(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],a=0,o=i.length,l;a<o;++a)(l=i[a])&&e.call(l,l.__data__,a,i);return this}function Us(e){return function(){this.removeAttribute(e)}}function qs(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ws(e,t){return function(){this.setAttribute(e,t)}}function Vs(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Ys(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Gs(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Ks(e,t){var n=zn(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?qs:Us:typeof t=="function"?n.local?Gs:Ys:n.local?Vs:Ws)(n,t))}function Bi(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Xs(e){return function(){this.style.removeProperty(e)}}function js(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Js(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Qs(e,t,n){return arguments.length>1?this.each((t==null?Xs:typeof t=="function"?Js:js)(e,t,n??"")):Ut(this.node(),e)}function Ut(e,t){return e.style.getPropertyValue(t)||Bi(e).getComputedStyle(e,null).getPropertyValue(t)}function Zs(e){return function(){delete this[e]}}function el(e,t){return function(){this[e]=t}}function tl(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function nl(e,t){return arguments.length>1?this.each((t==null?Zs:typeof t=="function"?tl:el)(e,t)):this.node()[e]}function zi(e){return e.trim().split(/^|\s+/)}function Mr(e){return e.classList||new Ui(e)}function Ui(e){this._node=e,this._names=zi(e.getAttribute("class")||"")}Ui.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function qi(e,t){for(var n=Mr(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Wi(e,t){for(var n=Mr(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function rl(e){return function(){qi(this,e)}}function il(e){return function(){Wi(this,e)}}function al(e,t){return function(){(t.apply(this,arguments)?qi:Wi)(this,e)}}function ol(e,t){var n=zi(e+"");if(arguments.length<2){for(var r=Mr(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?al:t?rl:il)(n,t))}function sl(){this.textContent=""}function ll(e){return function(){this.textContent=e}}function cl(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function ul(e){return arguments.length?this.each(e==null?sl:(typeof e=="function"?cl:ll)(e)):this.node().textContent}function fl(){this.innerHTML=""}function hl(e){return function(){this.innerHTML=e}}function dl(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function pl(e){return arguments.length?this.each(e==null?fl:(typeof e=="function"?dl:hl)(e)):this.node().innerHTML}function ml(){this.nextSibling&&this.parentNode.appendChild(this)}function gl(){return this.each(ml)}function vl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function _l(){return this.each(vl)}function yl(e){var t=typeof e=="function"?e:Oi(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function wl(){return null}function xl(e,t){var n=typeof e=="function"?e:Oi(e),r=t==null?wl:typeof t=="function"?t:Ir(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function bl(){var e=this.parentNode;e&&e.removeChild(this)}function kl(){return this.each(bl)}function Al(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function El(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Il(e){return this.select(e?El:Al)}function Ml(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Cl(e){return function(t){e.call(this,t,this.__data__)}}function Nl(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Sl(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,a;n<i;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++r]=a;++r?t.length=r:delete this.__on}}}function Tl(e,t,n){return function(){var r=this.__on,i,a=Cl(t);if(r){for(var o=0,l=r.length;o<l;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=t;return}}this.addEventListener(e.type,a,n),i={type:e.type,name:e.name,value:t,listener:a,options:n},r?r.push(i):this.__on=[i]}}function Rl(e,t,n){var r=Nl(e+""),i,a=r.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,s=l.length,f;c<s;++c)for(i=0,f=l[c];i<a;++i)if((o=r[i]).type===f.type&&o.name===f.name)return f.value}return}for(l=t?Tl:Sl,i=0;i<a;++i)this.each(l(r[i],t,n));return this}function Vi(e,t,n){var r=Bi(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function Dl(e,t){return function(){return Vi(this,e,t)}}function Ll(e,t){return function(){return Vi(this,e,t.apply(this,arguments))}}function Ol(e,t){return this.each((typeof t=="function"?Ll:Dl)(e,t))}function*Pl(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length,o;i<a;++i)(o=r[i])&&(yield o)}var Yi=[null];function He(e,t){this._groups=e,this._parents=t}function fn(){return new He([[document.documentElement]],Yi)}function Fl(){return this}He.prototype=fn.prototype={constructor:He,select:cs,selectAll:ds,selectChild:vs,selectChildren:xs,filter:bs,data:Cs,enter:ks,exit:Ss,join:Ts,merge:Rs,selection:Fl,order:Ds,sort:Ls,call:Ps,nodes:Fs,node:$s,size:Hs,empty:Bs,each:zs,attr:Ks,style:Qs,property:nl,classed:ol,text:ul,html:pl,raise:gl,lower:_l,append:yl,insert:xl,remove:kl,clone:Il,datum:Ml,on:Rl,dispatch:Ol,[Symbol.iterator]:Pl};function $l(e){return typeof e=="string"?new He([[document.querySelector(e)]],[document.documentElement]):new He([[e]],Yi)}function Cr(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Gi(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function hn(){}var an=.7,Rn=1/an,zt="\\s*([+-]?\\d+)\\s*",on="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",nt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Hl=/^#([0-9a-f]{3,8})$/,Bl=new RegExp(`^rgb\\(${zt},${zt},${zt}\\)$`),zl=new RegExp(`^rgb\\(${nt},${nt},${nt}\\)$`),Ul=new RegExp(`^rgba\\(${zt},${zt},${zt},${on}\\)$`),ql=new RegExp(`^rgba\\(${nt},${nt},${nt},${on}\\)$`),Wl=new RegExp(`^hsl\\(${on},${nt},${nt}\\)$`),Vl=new RegExp(`^hsla\\(${on},${nt},${nt},${on}\\)$`),ei={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Cr(hn,It,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ti,formatHex:ti,formatHex8:Yl,formatHsl:Gl,formatRgb:ni,toString:ni});function ti(){return this.rgb().formatHex()}function Yl(){return this.rgb().formatHex8()}function Gl(){return Ki(this).formatHsl()}function ni(){return this.rgb().formatRgb()}function It(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Hl.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?ri(t):n===3?new Pe(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?gn(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?gn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Bl.exec(e))?new Pe(t[1],t[2],t[3],1):(t=zl.exec(e))?new Pe(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ul.exec(e))?gn(t[1],t[2],t[3],t[4]):(t=ql.exec(e))?gn(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Wl.exec(e))?oi(t[1],t[2]/100,t[3]/100,1):(t=Vl.exec(e))?oi(t[1],t[2]/100,t[3]/100,t[4]):ei.hasOwnProperty(e)?ri(ei[e]):e==="transparent"?new Pe(NaN,NaN,NaN,0):null}function ri(e){return new Pe(e>>16&255,e>>8&255,e&255,1)}function gn(e,t,n,r){return r<=0&&(e=t=n=NaN),new Pe(e,t,n,r)}function Kl(e){return e instanceof hn||(e=It(e)),e?(e=e.rgb(),new Pe(e.r,e.g,e.b,e.opacity)):new Pe}function mr(e,t,n,r){return arguments.length===1?Kl(e):new Pe(e,t,n,r??1)}function Pe(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Cr(Pe,mr,Gi(hn,{brighter(e){return e=e==null?Rn:Math.pow(Rn,e),new Pe(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?an:Math.pow(an,e),new Pe(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Pe(Et(this.r),Et(this.g),Et(this.b),Dn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ii,formatHex:ii,formatHex8:Xl,formatRgb:ai,toString:ai}));function ii(){return`#${xt(this.r)}${xt(this.g)}${xt(this.b)}`}function Xl(){return`#${xt(this.r)}${xt(this.g)}${xt(this.b)}${xt((isNaN(this.opacity)?1:this.opacity)*255)}`}function ai(){const e=Dn(this.opacity);return`${e===1?"rgb(":"rgba("}${Et(this.r)}, ${Et(this.g)}, ${Et(this.b)}${e===1?")":`, ${e})`}`}function Dn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Et(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function xt(e){return e=Et(e),(e<16?"0":"")+e.toString(16)}function oi(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new je(e,t,n,r)}function Ki(e){if(e instanceof je)return new je(e.h,e.s,e.l,e.opacity);if(e instanceof hn||(e=It(e)),!e)return new je;if(e instanceof je)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,l=a-i,c=(a+i)/2;return l?(t===a?o=(n-r)/l+(n<r)*6:n===a?o=(r-t)/l+2:o=(t-n)/l+4,l/=c<.5?a+i:2-a-i,o*=60):l=c>0&&c<1?0:o,new je(o,l,c,e.opacity)}function jl(e,t,n,r){return arguments.length===1?Ki(e):new je(e,t,n,r??1)}function je(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Cr(je,jl,Gi(hn,{brighter(e){return e=e==null?Rn:Math.pow(Rn,e),new je(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?an:Math.pow(an,e),new je(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Pe(ir(e>=240?e-240:e+120,i,r),ir(e,i,r),ir(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new je(si(this.h),vn(this.s),vn(this.l),Dn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Dn(this.opacity);return`${e===1?"hsl(":"hsla("}${si(this.h)}, ${vn(this.s)*100}%, ${vn(this.l)*100}%${e===1?")":`, ${e})`}`}}));function si(e){return e=(e||0)%360,e<0?e+360:e}function vn(e){return Math.max(0,Math.min(1,e||0))}function ir(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Nr=e=>()=>e;function Jl(e,t){return function(n){return e+n*t}}function Ql(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Zl(e){return(e=+e)==1?Xi:function(t,n){return n-t?Ql(t,n,e):Nr(isNaN(t)?n:t)}}function Xi(e,t){var n=t-e;return n?Jl(e,n):Nr(isNaN(e)?t:e)}const Ln=function e(t){var n=Zl(t);function r(i,a){var o=n((i=mr(i)).r,(a=mr(a)).r),l=n(i.g,a.g),c=n(i.b,a.b),s=Xi(i.opacity,a.opacity);return function(f){return i.r=o(f),i.g=l(f),i.b=c(f),i.opacity=s(f),i+""}}return r.gamma=e,r}(1);function ec(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=e[i]*(1-a)+t[i]*a;return r}}function tc(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function nc(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=bt(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(l){for(o=0;o<r;++o)a[o]=i[o](l);return a}}function rc(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Ke(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function ic(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=bt(e[i],t[i]):r[i]=t[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var gr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ar=new RegExp(gr.source,"g");function ac(e){return function(){return e}}function oc(e){return function(t){return e(t)+""}}function ji(e,t){var n=gr.lastIndex=ar.lastIndex=0,r,i,a,o=-1,l=[],c=[];for(e=e+"",t=t+"";(r=gr.exec(e))&&(i=ar.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),l[o]?l[o]+=a:l[++o]=a),(r=r[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,c.push({i:o,x:Ke(r,i)})),n=ar.lastIndex;return n<t.length&&(a=t.slice(n),l[o]?l[o]+=a:l[++o]=a),l.length<2?c[0]?oc(c[0].x):ac(t):(t=c.length,function(s){for(var f=0,p;f<t;++f)l[(p=c[f]).i]=p.x(s);return l.join("")})}function bt(e,t){var n=typeof t,r;return t==null||n==="boolean"?Nr(t):(n==="number"?Ke:n==="string"?(r=It(t))?(t=r,Ln):ji:t instanceof It?Ln:t instanceof Date?rc:tc(t)?ec:Array.isArray(t)?nc:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?ic:Ke)(e,t)}function sc(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var li=180/Math.PI,vr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ji(e,t,n,r,i,a){var o,l,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,c/=l),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*li,skewX:Math.atan(c)*li,scaleX:o,scaleY:l}}var _n;function lc(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?vr:Ji(t.a,t.b,t.c,t.d,t.e,t.f)}function cc(e){return e==null||(_n||(_n=document.createElementNS("http://www.w3.org/2000/svg","g")),_n.setAttribute("transform",e),!(e=_n.transform.baseVal.consolidate()))?vr:(e=e.matrix,Ji(e.a,e.b,e.c,e.d,e.e,e.f))}function Qi(e,t,n,r){function i(s){return s.length?s.pop()+" ":""}function a(s,f,p,h,v,_){if(s!==p||f!==h){var S=v.push("translate(",null,t,null,n);_.push({i:S-4,x:Ke(s,p)},{i:S-2,x:Ke(f,h)})}else(p||h)&&v.push("translate("+p+t+h+n)}function o(s,f,p,h){s!==f?(s-f>180?f+=360:f-s>180&&(s+=360),h.push({i:p.push(i(p)+"rotate(",null,r)-2,x:Ke(s,f)})):f&&p.push(i(p)+"rotate("+f+r)}function l(s,f,p,h){s!==f?h.push({i:p.push(i(p)+"skewX(",null,r)-2,x:Ke(s,f)}):f&&p.push(i(p)+"skewX("+f+r)}function c(s,f,p,h,v,_){if(s!==p||f!==h){var S=v.push(i(v)+"scale(",null,",",null,")");_.push({i:S-4,x:Ke(s,p)},{i:S-2,x:Ke(f,h)})}else(p!==1||h!==1)&&v.push(i(v)+"scale("+p+","+h+")")}return function(s,f){var p=[],h=[];return s=e(s),f=e(f),a(s.translateX,s.translateY,f.translateX,f.translateY,p,h),o(s.rotate,f.rotate,p,h),l(s.skewX,f.skewX,p,h),c(s.scaleX,s.scaleY,f.scaleX,f.scaleY,p,h),s=f=null,function(v){for(var _=-1,S=h.length,R;++_<S;)p[(R=h[_]).i]=R.x(v);return p.join("")}}}var uc=Qi(lc,"px, ","px)","deg)"),fc=Qi(cc,", ",")",")"),qt=0,tn=0,Jt=0,Zi=1e3,On,nn,Pn=0,Mt=0,Un=0,sn=typeof performance=="object"&&performance.now?performance:Date,ea=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Sr(){return Mt||(ea(hc),Mt=sn.now()+Un)}function hc(){Mt=0}function Fn(){this._call=this._time=this._next=null}Fn.prototype=ta.prototype={constructor:Fn,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Sr():+n)+(t==null?0:+t),!this._next&&nn!==this&&(nn?nn._next=this:On=this,nn=this),this._call=e,this._time=n,_r()},stop:function(){this._call&&(this._call=null,this._time=1/0,_r())}};function ta(e,t,n){var r=new Fn;return r.restart(e,t,n),r}function dc(){Sr(),++qt;for(var e=On,t;e;)(t=Mt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--qt}function ci(){Mt=(Pn=sn.now())+Un,qt=tn=0;try{dc()}finally{qt=0,mc(),Mt=0}}function pc(){var e=sn.now(),t=e-Pn;t>Zi&&(Un-=t,Pn=e)}function mc(){for(var e,t=On,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:On=n);nn=e,_r(r)}function _r(e){if(!qt){tn&&(tn=clearTimeout(tn));var t=e-Mt;t>24?(e<1/0&&(tn=setTimeout(ci,e-sn.now()-Un)),Jt&&(Jt=clearInterval(Jt))):(Jt||(Pn=sn.now(),Jt=setInterval(pc,Zi)),qt=1,ea(ci))}}function ui(e,t,n){var r=new Fn;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var gc=Li("start","end","cancel","interrupt"),vc=[],na=0,fi=1,yr=2,In=3,hi=4,wr=5,Mn=6;function qn(e,t,n,r,i,a){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;_c(e,n,{name:t,index:r,group:i,on:gc,tween:vc,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:na})}function Tr(e,t){var n=Je(e,t);if(n.state>na)throw new Error("too late; already scheduled");return n}function rt(e,t){var n=Je(e,t);if(n.state>In)throw new Error("too late; already running");return n}function Je(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function _c(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=ta(a,0,n.time);function a(s){n.state=fi,n.timer.restart(o,n.delay,n.time),n.delay<=s&&o(s-n.delay)}function o(s){var f,p,h,v;if(n.state!==fi)return c();for(f in r)if(v=r[f],v.name===n.name){if(v.state===In)return ui(o);v.state===hi?(v.state=Mn,v.timer.stop(),v.on.call("interrupt",e,e.__data__,v.index,v.group),delete r[f]):+f<t&&(v.state=Mn,v.timer.stop(),v.on.call("cancel",e,e.__data__,v.index,v.group),delete r[f])}if(ui(function(){n.state===In&&(n.state=hi,n.timer.restart(l,n.delay,n.time),l(s))}),n.state=yr,n.on.call("start",e,e.__data__,n.index,n.group),n.state===yr){for(n.state=In,i=new Array(h=n.tween.length),f=0,p=-1;f<h;++f)(v=n.tween[f].value.call(e,e.__data__,n.index,n.group))&&(i[++p]=v);i.length=p+1}}function l(s){for(var f=s<n.duration?n.ease.call(null,s/n.duration):(n.timer.restart(c),n.state=wr,1),p=-1,h=i.length;++p<h;)i[p].call(e,f);n.state===wr&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Mn,n.timer.stop(),delete r[t];for(var s in r)return;delete e.__transition}}function yc(e,t){var n=e.__transition,r,i,a=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){a=!1;continue}i=r.state>yr&&r.state<wr,r.state=Mn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}a&&delete e.__transition}}function wc(e){return this.each(function(){yc(this,e)})}function xc(e,t){var n,r;return function(){var i=rt(this,e),a=i.tween;if(a!==n){r=n=a;for(var o=0,l=r.length;o<l;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function bc(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var a=rt(this,e),o=a.tween;if(o!==r){i=(r=o).slice();for(var l={name:t,value:n},c=0,s=i.length;c<s;++c)if(i[c].name===t){i[c]=l;break}c===s&&i.push(l)}a.tween=i}}function kc(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Je(this.node(),n).tween,i=0,a=r.length,o;i<a;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?xc:bc)(n,e,t))}function Rr(e,t,n){var r=e._id;return e.each(function(){var i=rt(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return Je(i,r).value[t]}}function ra(e,t){var n;return(typeof t=="number"?Ke:t instanceof It?Ln:(n=It(t))?(t=n,Ln):ji)(e,t)}function Ac(e){return function(){this.removeAttribute(e)}}function Ec(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ic(e,t,n){var r,i=n+"",a;return function(){var o=this.getAttribute(e);return o===i?null:o===r?a:a=t(r=o,n)}}function Mc(e,t,n){var r,i=n+"",a;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?a:a=t(r=o,n)}}function Cc(e,t,n){var r,i,a;return function(){var o,l=n(this),c;return l==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=l+"",o===c?null:o===r&&c===i?a:(i=c,a=t(r=o,l)))}}function Nc(e,t,n){var r,i,a;return function(){var o,l=n(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=l+"",o===c?null:o===r&&c===i?a:(i=c,a=t(r=o,l)))}}function Sc(e,t){var n=zn(e),r=n==="transform"?fc:ra;return this.attrTween(e,typeof t=="function"?(n.local?Nc:Cc)(n,r,Rr(this,"attr."+e,t)):t==null?(n.local?Ec:Ac)(n):(n.local?Mc:Ic)(n,r,t))}function Tc(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Rc(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Dc(e,t){var n,r;function i(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&Rc(e,a)),n}return i._value=t,i}function Lc(e,t){var n,r;function i(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&Tc(e,a)),n}return i._value=t,i}function Oc(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=zn(e);return this.tween(n,(r.local?Dc:Lc)(r,t))}function Pc(e,t){return function(){Tr(this,e).delay=+t.apply(this,arguments)}}function Fc(e,t){return t=+t,function(){Tr(this,e).delay=t}}function $c(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Pc:Fc)(t,e)):Je(this.node(),t).delay}function Hc(e,t){return function(){rt(this,e).duration=+t.apply(this,arguments)}}function Bc(e,t){return t=+t,function(){rt(this,e).duration=t}}function zc(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Hc:Bc)(t,e)):Je(this.node(),t).duration}function Uc(e,t){if(typeof t!="function")throw new Error;return function(){rt(this,e).ease=t}}function qc(e){var t=this._id;return arguments.length?this.each(Uc(t,e)):Je(this.node(),t).ease}function Wc(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;rt(this,e).ease=n}}function Vc(e){if(typeof e!="function")throw new Error;return this.each(Wc(this._id,e))}function Yc(e){typeof e!="function"&&(e=Fi(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,l=r[i]=[],c,s=0;s<o;++s)(c=a[s])&&e.call(c,c.__data__,s,a)&&l.push(c);return new ft(r,this._parents,this._name,this._id)}function Gc(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),l=0;l<a;++l)for(var c=t[l],s=n[l],f=c.length,p=o[l]=new Array(f),h,v=0;v<f;++v)(h=c[v]||s[v])&&(p[v]=h);for(;l<r;++l)o[l]=t[l];return new ft(o,this._parents,this._name,this._id)}function Kc(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Xc(e,t,n){var r,i,a=Kc(t)?Tr:rt;return function(){var o=a(this,e),l=o.on;l!==r&&(i=(r=l).copy()).on(t,n),o.on=i}}function jc(e,t){var n=this._id;return arguments.length<2?Je(this.node(),n).on.on(e):this.each(Xc(n,e,t))}function Jc(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Qc(){return this.on("end.remove",Jc(this._id))}function Zc(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Ir(e));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var l=r[o],c=l.length,s=a[o]=new Array(c),f,p,h=0;h<c;++h)(f=l[h])&&(p=e.call(f,f.__data__,h,l))&&("__data__"in f&&(p.__data__=f.__data__),s[h]=p,qn(s[h],t,n,h,s,Je(f,n)));return new ft(a,this._parents,t,n)}function eu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Pi(e));for(var r=this._groups,i=r.length,a=[],o=[],l=0;l<i;++l)for(var c=r[l],s=c.length,f,p=0;p<s;++p)if(f=c[p]){for(var h=e.call(f,f.__data__,p,c),v,_=Je(f,n),S=0,R=h.length;S<R;++S)(v=h[S])&&qn(v,t,n,S,h,_);a.push(h),o.push(f)}return new ft(a,o,t,n)}var tu=fn.prototype.constructor;function nu(){return new tu(this._groups,this._parents)}function ru(e,t){var n,r,i;return function(){var a=Ut(this,e),o=(this.style.removeProperty(e),Ut(this,e));return a===o?null:a===n&&o===r?i:i=t(n=a,r=o)}}function ia(e){return function(){this.style.removeProperty(e)}}function iu(e,t,n){var r,i=n+"",a;return function(){var o=Ut(this,e);return o===i?null:o===r?a:a=t(r=o,n)}}function au(e,t,n){var r,i,a;return function(){var o=Ut(this,e),l=n(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),Ut(this,e))),o===c?null:o===r&&c===i?a:(i=c,a=t(r=o,l))}}function ou(e,t){var n,r,i,a="style."+t,o="end."+a,l;return function(){var c=rt(this,e),s=c.on,f=c.value[a]==null?l||(l=ia(t)):void 0;(s!==n||i!==f)&&(r=(n=s).copy()).on(o,i=f),c.on=r}}function su(e,t,n){var r=(e+="")=="transform"?uc:ra;return t==null?this.styleTween(e,ru(e,r)).on("end.style."+e,ia(e)):typeof t=="function"?this.styleTween(e,au(e,r,Rr(this,"style."+e,t))).each(ou(this._id,e)):this.styleTween(e,iu(e,r,t),n).on("end.style."+e,null)}function lu(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function cu(e,t,n){var r,i;function a(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&lu(e,o,n)),r}return a._value=t,a}function uu(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,cu(e,t,n??""))}function fu(e){return function(){this.textContent=e}}function hu(e){return function(){var t=e(this);this.textContent=t??""}}function du(e){return this.tween("text",typeof e=="function"?hu(Rr(this,"text",e)):fu(e==null?"":e+""))}function pu(e){return function(t){this.textContent=e.call(this,t)}}function mu(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&pu(i)),t}return r._value=e,r}function gu(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,mu(e))}function vu(){for(var e=this._name,t=this._id,n=aa(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],l=o.length,c,s=0;s<l;++s)if(c=o[s]){var f=Je(c,t);qn(c,e,n,s,o,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new ft(r,this._parents,e,n)}function _u(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var l={value:o},c={value:function(){--i===0&&a()}};n.each(function(){var s=rt(this,r),f=s.on;f!==e&&(t=(e=f).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),s.on=t}),i===0&&a()})}var yu=0;function ft(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function aa(){return++yu}var ct=fn.prototype;ft.prototype={constructor:ft,select:Zc,selectAll:eu,selectChild:ct.selectChild,selectChildren:ct.selectChildren,filter:Yc,merge:Gc,selection:nu,transition:vu,call:ct.call,nodes:ct.nodes,node:ct.node,size:ct.size,empty:ct.empty,each:ct.each,on:jc,attr:Sc,attrTween:Oc,style:su,styleTween:uu,text:du,textTween:gu,remove:Qc,tween:kc,delay:$c,duration:zc,ease:qc,easeVarying:Vc,end:_u,[Symbol.iterator]:ct[Symbol.iterator]};function wu(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var xu={time:null,delay:0,duration:250,ease:wu};function bu(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function ku(e){var t,n;e instanceof ft?(t=e._id,e=e._name):(t=aa(),(n=xu).time=Sr(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],l=o.length,c,s=0;s<l;++s)(c=o[s])&&qn(c,e,t,s,o,n||bu(c,t));return new ft(r,this._parents,e,t)}fn.prototype.interrupt=wc;fn.prototype.transition=ku;function Au(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function $n(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Wt(e){return e=$n(Math.abs(e)),e?e[1]:NaN}function Eu(e,t){return function(n,r){for(var i=n.length,a=[],o=0,l=e[0],c=0;i>0&&l>0&&(c+l+1>r&&(l=Math.max(1,r-c)),a.push(n.substring(i-=l,i+l)),!((c+=l+1)>r));)l=e[o=(o+1)%e.length];return a.reverse().join(t)}}function Iu(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Mu=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Hn(e){if(!(t=Mu.exec(e)))throw new Error("invalid format: "+e);var t;return new Dr({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Hn.prototype=Dr.prototype;function Dr(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Dr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Cu(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var oa;function Nu(e,t){var n=$n(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(oa=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+$n(e,Math.max(0,t+a-1))[0]}function di(e,t){var n=$n(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const pi={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Au,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>di(e*100,t),r:di,s:Nu,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function mi(e){return e}var gi=Array.prototype.map,vi=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];function Su(e){var t=e.grouping===void 0||e.thousands===void 0?mi:Eu(gi.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?mi:Iu(gi.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"â":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function s(p){p=Hn(p);var h=p.fill,v=p.align,_=p.sign,S=p.symbol,R=p.zero,q=p.width,Q=p.comma,V=p.precision,z=p.trim,U=p.type;U==="n"?(Q=!0,U="g"):pi[U]||(V===void 0&&(V=12),z=!0,U="g"),(R||h==="0"&&v==="=")&&(R=!0,h="0",v="=");var me=S==="$"?n:S==="#"&&/[boxX]/.test(U)?"0"+U.toLowerCase():"",Z=S==="$"?r:/[%p]/.test(U)?o:"",d=pi[U],m=/[defgprs%]/.test(U);V=V===void 0?6:/[gprs]/.test(U)?Math.max(1,Math.min(21,V)):Math.max(0,Math.min(20,V));function y(w){var g=me,M=Z,Y,te,K;if(U==="c")M=d(w)+M,w="";else{w=+w;var N=w<0||1/w<0;if(w=isNaN(w)?c:d(Math.abs(w),V),z&&(w=Cu(w)),N&&+w==0&&_!=="+"&&(N=!1),g=(N?_==="("?_:l:_==="-"||_==="("?"":_)+g,M=(U==="s"?vi[8+oa/3]:"")+M+(N&&_==="("?")":""),m){for(Y=-1,te=w.length;++Y<te;)if(K=w.charCodeAt(Y),48>K||K>57){M=(K===46?i+w.slice(Y+1):w.slice(Y))+M,w=w.slice(0,Y);break}}}Q&&!R&&(w=t(w,1/0));var j=g.length+w.length+M.length,T=j<q?new Array(q-j+1).join(h):"";switch(Q&&R&&(w=t(T+w,T.length?q-M.length:1/0),T=""),v){case"<":w=g+w+M+T;break;case"=":w=g+T+w+M;break;case"^":w=T.slice(0,j=T.length>>1)+g+w+M+T.slice(j);break;default:w=T+g+w+M;break}return a(w)}return y.toString=function(){return p+""},y}function f(p,h){var v=s((p=Hn(p),p.type="f",p)),_=Math.max(-8,Math.min(8,Math.floor(Wt(h)/3)))*3,S=Math.pow(10,-_),R=vi[8+_/3];return function(q){return v(S*q)+R}}return{format:s,formatPrefix:f}}var yn,$t,sa;Tu({thousands:",",grouping:[3],currency:["$",""]});function Tu(e){return yn=Su(e),$t=yn.format,sa=yn.formatPrefix,yn}function Ru(e){return Math.max(0,-Wt(Math.abs(e)))}function Du(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Wt(t)/3)))*3-Wt(Math.abs(e)))}function Lu(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Wt(t)-Wt(e))+1}function Ou(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Pu(e){return function(){return e}}function Fu(e){return+e}var _i=[0,1];function Ht(e){return e}function xr(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Pu(isNaN(t)?NaN:.5)}function $u(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function Hu(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=xr(i,r),a=n(o,a)):(r=xr(r,i),a=n(a,o)),function(l){return a(r(l))}}function Bu(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=xr(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(l){var c=qo(e,l,1,r)-1;return a[c](i[c](l))}}function zu(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Uu(){var e=_i,t=_i,n=bt,r,i,a,o=Ht,l,c,s;function f(){var h=Math.min(e.length,t.length);return o!==Ht&&(o=$u(e[0],e[h-1])),l=h>2?Bu:Hu,c=s=null,p}function p(h){return h==null||isNaN(h=+h)?a:(c||(c=l(e.map(r),t,n)))(r(o(h)))}return p.invert=function(h){return o(i((s||(s=l(t,e.map(r),Ke)))(h)))},p.domain=function(h){return arguments.length?(e=Array.from(h,Fu),f()):e.slice()},p.range=function(h){return arguments.length?(t=Array.from(h),f()):t.slice()},p.rangeRound=function(h){return t=Array.from(h),n=sc,f()},p.clamp=function(h){return arguments.length?(o=h?!0:Ht,f()):o!==Ht},p.interpolate=function(h){return arguments.length?(n=h,f()):n},p.unknown=function(h){return arguments.length?(a=h,p):a},function(h,v){return r=h,i=v,f()}}function qu(){return Uu()(Ht,Ht)}function Wu(e,t,n,r){var i=Ko(e,t,n),a;switch(r=Hn(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(a=Du(i,o))&&(r.precision=a),sa(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=Lu(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=Ru(i))&&(r.precision=a-(r.type==="%")*2);break}}return $t(r)}function Vu(e){var t=e.domain;return e.ticks=function(n){var r=t();return Go(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return Wu(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,a=r.length-1,o=r[i],l=r[a],c,s,f=10;for(l<o&&(s=o,o=l,l=s,s=i,i=a,a=s);f-- >0;){if(s=hr(o,l,n),s===c)return r[i]=o,r[a]=l,t(r);if(s>0)o=Math.floor(o/s)*s,l=Math.ceil(l/s)*s;else if(s<0)o=Math.ceil(o*s)/s,l=Math.floor(l*s)/s;else break;c=s}return e},e}function br(){var e=qu();return e.copy=function(){return zu(e,br())},Ou.apply(e,arguments),Vu(e)}function rn(e,t,n){this.k=e,this.x=t,this.y=n}rn.prototype={constructor:rn,scale:function(e){return e===1?this:new rn(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new rn(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};rn.prototype;const Le={BLACK:"#000000",BLUE_98:"#F7FAFD",BLUE:"#2C6496",BLUE_LIGHT:"#D8E6F3",BLUE_PRESSED:"#17354F",DARK_BLUE_HOVER:"#1d3e5e",DARK_GRAY:"#616161",DARK_RED:"#b50d0d",DARKEST_BLUE:"#0C1A27",GRAY:"#808080",LIGHT_GRAY:"#F2F2F2",MEDIUM_DARK_GRAY:"#D2D2D2",MEDIUM_LIGHT_GRAY:"#BDBDBD",TEAL_ACCENT:"#39C6C0",TEAL_LIGHT:"#F7FDFC",TEAL_MEDIUM:"#2D9E99",TEAL_PRESSED:"#227773",WHITE:"#FFFFFF"},wn={scatterPositive:Le.TEAL_MEDIUM,scatterNegative:Le.DARK_GRAY,scatterNeutral:Le.MEDIUM_DARK_GRAY};function Yu(e){return e==null||isNaN(e)||typeof e!="number"||Math.abs(e)<.1?wn.scatterNeutral:e>0?wn.scatterPositive:wn.scatterNegative}var Gu=xe('<div class="chart-container svelte-1dq6vrn"><canvas class="main-canvas svelte-1dq6vrn"></canvas> <svg class="overlay-svg svelte-1dq6vrn"></svg></div>');function Ku(e,t){cn(t,!1);let n=Ie(t,"data",24,()=>[]),r=Ie(t,"scrollStates",24,()=>[]),i=Ie(t,"currentStateIndex",8,0),a=Ie(t,"previousStateIndex",8,0),o=Ie(t,"isTransitioning",8,!1),l=Ie(t,"interpolationT",8,0),c=Ie(t,"randomHouseholds",24,()=>({})),s=Ie(t,"selectedHousehold",8,null),f=Ie(t,"onPointClick",8,()=>{}),p=we(),h=we(),v=[],_={top:60,right:100,bottom:100,left:120},S=900,R=600;function q(){const g=window.innerWidth;g<=480?_={top:40,right:15,bottom:50,left:50}:g<=768?_={top:50,right:30,bottom:70,left:65}:_={top:60,right:100,bottom:100,left:120}}function Q(g){var L,C;const M=u(p).getBoundingClientRect(),Y=g.clientX||g.touches&&((L=g.touches[0])==null?void 0:L.clientX),te=g.clientY||g.touches&&((C=g.touches[0])==null?void 0:C.clientY);if(!Y||!te)return;const K=Y-M.left,N=te-M.top;let j=null,T=20;for(const D of v){const E=K-D.x,X=N-D.y,O=Math.sqrt(E*E+X*X);O<T&&O<D.radius+5&&(T=O,j=D)}j&&f()(j.data)}function V(){if(!(!u(p)||!n().length))try{const g=u(p).getContext("2d",{alpha:!1,desynchronized:!0}),M=r()[i()],Y=o()?r()[a()]:M,te=M,K=M,N=te;if(!K||!N)return;const j=bt(Y.yDomain[0],N.yDomain[0])(l()),T=bt(Y.yDomain[1],N.yDomain[1])(l()),L=N.xDomain[0],C=N.xDomain[1],D=Math.max(Math.abs(L),Math.abs(C)),E=-D,X=D,O=Y.xDomain[0],re=Y.xDomain[1],be=Math.max(Math.abs(O),Math.abs(re)),ee=-be,x=be,b=bt(ee,E)(l()),k=bt(x,X)(l());g.fillStyle=Le.WHITE,g.fillRect(0,0,S,R);let F=n();o()&&Y&&te?F=n().filter(A=>{const J=Y.filter?Y.filter(A):!0,B=te.filter?te.filter(A):!0;return J||B}):F=n().filter(A=>K.filter?K.filter(A):!0);const G=br().domain([b,k]).range([_.left,S-_.right]),I=br().domain([j,T]).range([R-_.bottom,_.top]);z(g,G,I,b,k,j,T),v=[];const P=U(F,G,I);me(g,F,G,I,P,M,Y),Z(G,I)}catch(g){console.error("Error rendering visualization:",g),u(p)&&u(p).getContext("2d").clearRect(0,0,S,R)}}function z(g,M,Y,te,K,N,j){const T=o()?.3+l()*.7:1;g.globalAlpha=T,g.strokeStyle=Le.MEDIUM_DARK_GRAY,g.lineWidth=.5,g.setLineDash([]);const L=Math.max(5,Math.floor((K-te)/10));for(let D=Math.ceil(te/L)*L;D<=K;D+=L){const E=M(D);g.beginPath(),g.moveTo(E,_.top),g.lineTo(E,R-_.bottom),g.stroke()}Y.ticks(6).forEach(D=>{const E=Y(D);g.beginPath(),g.moveTo(_.left,E),g.lineTo(S-_.right,E),g.stroke()}),g.globalAlpha=1,te<=0&&K>=0&&(g.strokeStyle=Le.BLACK,g.lineWidth=2,g.beginPath(),g.moveTo(M(0),_.top),g.lineTo(M(0),R-_.bottom),g.stroke())}function U(g,M,Y){let te=1/0,K=-1/0;return g.forEach(N=>{const j=M(N["Percentage Change in Net Income"]),T=Y(N["Gross Income"]);if(j>=_.left&&j<=S-_.right&&T>=_.top&&T<=R-_.bottom){const L=N["Household weight"]||N["Household Weight"]||1;te=Math.min(te,L),K=Math.max(K,L)}}),(te===1/0||K===-1/0||te===K)&&(te=1,K=1e5),{minWeight:te,maxWeight:K}}function me(g,M,Y,te,K,N,j){const{minWeight:T,maxWeight:L}=K,D=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?1e4:M.length;M.slice(0,D).forEach(X=>{var ne,se;let O=Y(X["Percentage Change in Net Income"]),re=te(X["Gross Income"]);const be=O<_.left||O>S-_.right||re<_.top||re>R-_.bottom;if(O<_.left?O=_.left+5:O>S-_.right&&(O=S-_.right-5),re<_.top||re>R-_.bottom)return;let ee=1;if(o()){const ke=j!=null&&j.filter?j.filter(X):!0,ue=N!=null&&N.filter?N.filter(X):!0;!ke&&ue?ee=l():ke&&!ue&&(ee=1-l())}else ee=(N!=null&&N.filter?N.filter(X):!0)?1:0;const x=Yu(X["Percentage Change in Net Income"]),b=X.isHighlighted&&X.stateIndex===Math.floor(i()/2),k=(se=(ne=r()[Math.floor(i()/2)])==null?void 0:ne.id)==null?void 0:se.replace("-individual",""),F=c()[k],G=(N==null?void 0:N.viewType)==="individual"&&F&&X.id===F.id,I=s()&&X.id===s().id,P=b||G||I,A=X["Household weight"]||X["Household Weight"]||1;let J=P?G||I?6:4:2;const B=Math.log10(A+1),oe=Math.log10(T+1),pe=Math.log10(L+1),he=.3+.55*((B-oe)/(pe-oe));let le=P?1:Math.min(Math.max(he,.3),.85);const ce=Bt.get(X.id);ce&&ce.isAnimating&&(J=J*ce.scale,le=Math.min(le*ce.opacity,1)),(N==null?void 0:N.viewType)==="individual"&&!G&&(le*=.3);const ye=le*ee;ye>.01&&(v.push({x:O,y:re,radius:J,data:X}),g.globalAlpha=ye,g.fillStyle=x,be?(g.beginPath(),O<=_.left+5?(g.moveTo(O+J,re),g.lineTo(O-J,re-J),g.lineTo(O-J,re+J)):O>=S-_.right-5&&(g.moveTo(O-J,re),g.lineTo(O+J,re-J),g.lineTo(O+J,re+J)),g.closePath(),g.fill()):(g.beginPath(),g.arc(O,re,J,0,2*Math.PI),g.fill(),P&&ye>.5&&(g.globalAlpha=ye,g.strokeStyle=Le.BLACK,g.lineWidth=1,g.stroke())))}),g.globalAlpha=1}function Z(g,M){if(!u(h))return;const Y=$l(u(h));Y.selectAll("*").remove();const te=Y.append("g"),K=window.innerWidth<=768,N=K?"10px":"14px",j=K?"10px":"14px",T=te.append("g").attr("transform",`translate(0,${R-_.bottom})`).call(ts(g).ticks(K?5:10).tickFormat(C=>`${C>0?"+":""}${C}%`)).style("font-family",mn("sans")).style("font-size",N).style("color",Le.DARKEST_BLUE),L=te.append("g").attr("transform",`translate(${_.left},0)`).call(ns(M).ticks(K?4:6).tickFormat(C=>K?C>=1e6?$t("$,.0s")(C).replace("M","M"):C>=1e3?$t("$,.0s")(C).replace("k","K"):$t("$,")(C):$t("$,")(C))).style("font-family",mn("sans")).style("font-size",j).style("color",Le.DARKEST_BLUE);T.select(".domain").style("stroke",Le.BLACK).style("stroke-width",1),L.select(".domain").style("stroke","none"),T.selectAll(".tick line").style("stroke",Le.BLACK).style("stroke-width",.5),L.selectAll(".tick line").style("stroke",Le.GRID_LINES).style("stroke-width",.5).style("opacity",.3),te.append("text").attr("x",S/2).attr("y",R-(K?5:30)).attr("text-anchor","middle").style("font-family",mn("sans")).style("font-size",K?"12px":"16px").style("font-weight","400").style("fill",Le.DARK_GRAY).text(K?"Change in income (2026) â":"Change in net income (2026) â"),te.append("text").attr("transform","rotate(-90)").attr("x",-R/2).attr("y",K?15:25).attr("text-anchor","middle").style("font-family",mn("sans")).style("font-size",K?"12px":"16px").style("font-weight","400").style("fill",Le.DARK_GRAY).text(K?"Annual income â":"Annual household market income â")}function d(){if(u(p)&&u(h)){const g=u(p).parentElement;S=g.clientWidth,R=g.clientHeight,q(),Ge(p,u(p).width=S),Ge(p,u(p).height=R),u(h).setAttribute("width",S),u(h).setAttribute("height",R),V()}}kr(()=>(d(),window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)})),kt(()=>(fe(n()),u(p)),()=>{n().length&&u(p)&&V()}),Bn(),ln();var m=Gu(),y=H(m);At(y,g=>ae(p,g),()=>u(p));var w=ie(y,2);return At(w,g=>ae(h,g),()=>u(h)),$(m),ut("click",y,Q),ut("touchstart",y,Q),de(e,m),no(t,"renderVisualization",V),un({renderVisualization:V})}var Xu=xe('<meta name="description" content="Interactive visualization showing how different American households are affected by tax policy changes" class="svelte-1se46nf"/>'),ju=xe('<p class="svelte-1se46nf"> </p>'),Ju=xe('<p class="svelte-1se46nf"> </p>'),Qu=xe('<p class="svelte-1se46nf"> </p>'),Zu=xe('<p class="svelte-1se46nf"> </p>'),ef=xe('<p class="svelte-1se46nf"><!></p>'),tf=xe('<div class="integrated-household-profile svelte-1se46nf"><!></div>'),nf=xe("<!> <!>",1),rf=xe('<p class="svelte-1se46nf"><!></p>'),af=xe('<p class="svelte-1se46nf"><!></p>'),of=xe("<!> <!>",1),sf=xe('<div class="scroll-indicator svelte-1se46nf"><span class="svelte-1se46nf">Scroll to explore</span> <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1se46nf"><path d="M12 5v14M19 12l-7 7-7-7" class="svelte-1se46nf"></path></svg></div>'),lf=xe('<section><div class="section-content svelte-1se46nf"><div class="drag-handle svelte-1se46nf" title="Drag to move">â®â®</div> <h2 class="svelte-1se46nf"> </h2> <!> <!></div></section>'),cf=xe('<div class="error-overlay svelte-1se46nf"><div class="error-content svelte-1se46nf"><h2 class="svelte-1se46nf">Error loading data</h2> <p class="svelte-1se46nf"> </p> <button class="svelte-1se46nf">Reload page</button></div></div>'),uf=xe('<div class="app-container svelte-1se46nf"><!> <div class="chart-background svelte-1se46nf"><!></div> <div class="content-overlay svelte-1se46nf"><div class="text-content svelte-1se46nf"></div></div> <!> <!></div>');function vf(e,t){cn(t,!1);const[n,r]=Ei(),i=()=>et(Pt,"$currentStateIndex",n),a=()=>et(kn,"$isTransitioning",n),o=()=>et(ur,"$currentInterpolationT",n),l=()=>et(Si,"$previousStateIndex",n),c=we();let s={},f=we([]),p=we(null),h=we(!1),v=we(null),_=we("tcja-expiration"),S=we({}),R=null,q=we([]),Q=we(null),V=we(null),z=we(null),U=!1,me=we(null),Z={x:0,y:0},d=we({});function m(x,b=!1,k=null){if(!x||x.length===0)return null;let F=0,G=0,I=0,P=0;const A=[];x.forEach(le=>{const ce=le["Household weight"]||le["Household Weight"]||1,ye=le["Percentage Change in Net Income"]||0;F+=ce,ye>0?(G+=ce,P+=ce):ye<0&&(I+=ce,P+=ce),b&&A.push({change:ye,weight:ce})});const J=F>0?Math.round(G/F*100):0,B=F>0?Math.round(I/F*100):0,oe=F>0?Math.round(P/F*100):0,pe=F/1e6,he={total:k==="highest-income"?pe.toFixed(1):Math.round(pe).toString(),totalRaw:F,positivePercent:J,negativePercent:B,affectedPercent:oe};if(b&&A.length>0){A.sort((ne,se)=>ne.change-se.change);let le=0;const ce=F/2;let ye=0;for(const ne of A)if(le+=ne.weight,le>=ce){ye=ne.change;break}he.medianChange=ye.toFixed(1)}return he}function y(){$e.forEach(x=>{if(x.viewType==="group"&&!u(S)[x.id]){const b=u(f).filter(F=>x.filter(F)),k=er(b);k&&Ge(S,u(S)[x.id]=k)}})}function w(){}function g(x,b){ae(me,b);const k=u(d)[b]||{x:0,y:0};Z={x:x.clientX-k.x,y:x.clientY-k.y},x.preventDefault()}function M(x){if(u(me)===null)return;const b={x:x.clientX-Z.x,y:x.clientY-Z.y};Ge(d,u(d)[u(me)]=b),ae(d,u(d))}function Y(){ae(me,null)}function te(x,b=!0){var F,G;if(!b){const I=P=>(P.preventDefault(),P.stopPropagation(),!1);window.addEventListener("scroll",I,{capture:!0}),(F=u(Q))==null||F.addEventListener("scroll",I,{capture:!0}),setTimeout(()=>{var P;window.removeEventListener("scroll",I,{capture:!0}),(P=u(Q))==null||P.removeEventListener("scroll",I,{capture:!0})},300)}ae(p,x);const k=$e[i()];if(k&&k.viewType==="group"){if(ae(S,{...u(S),[k.id]:x}),b){const I=i()+1;$e[I]&&$e[I].viewType==="individual"&&u(q)[I]&&u(q)[I].scrollIntoView({behavior:"smooth",block:"center"})}}else if(k&&k.viewType==="individual"){const I=k.id.replace("-individual","");ae(S,{...u(S),[I]:x});const P=Math.floor(i()/2);tr(`num-dependents-${P}`,0,Math.round(x["Number of Dependents"]||x.Dependents||0),A=>Math.round(A),700),tr(`age-of-head-${P}`,18,x["Age of Head"]||x.Age||40,A=>Math.round(A),800)}Gr(x.id),Wr(x.id,u(_)),(G=u(V))!=null&&G.renderVisualization&&u(V).renderVisualization()}function K(){var k,F,G,I;const x=((F=(k=u(c))==null?void 0:k.id)==null?void 0:F.replace("-individual",""))||((G=u(c))==null?void 0:G.id),b=$e.find(P=>P.id===x);if(b&&u(f).length>0){const P=u(f).filter(J=>b.filter(J)),A=er(P);if(A){te(A,!1);const J=Math.floor(i()/2);tr(`household-id-${J}`,((I=u(p))==null?void 0:I.id)||0,A.id,B=>Math.round(B),600)}}}function N(x){var I,P,A,J,B,oe;if(!s[x]){console.error("Dataset not loaded:",x);return}const b=((I=u(Q))==null?void 0:I.scrollTop)||0;console.log("Switching from",u(_),"to",x),console.log("Old dataset length:",u(f).length),console.log("New dataset length:",(P=s[x])==null?void 0:P.length);const k=(A=u(p))==null?void 0:A.id;u(f).length>0&&((J=s[x])==null?void 0:J.length)>0&&["1","100","1000","10000"].forEach(ge=>{const he=u(f).find(ce=>String(ce.id)===ge),le=s[x].find(ce=>String(ce.id)===ge);he&&le&&console.log(`Sample household ${ge} comparison:`,{oldNetIncome:he["Total Change in Net Income"]||he["Change in Household Net Income"],newNetIncome:le["Total Change in Net Income"]||le["Change in Household Net Income"],oldPercentChange:he["Percentage Change in Net Income"],newPercentChange:le["Percentage Change in Net Income"]})}),ae(_,x),ae(f,s[x]);const F={...u(S)},G={};if(Object.entries(F).forEach(([pe,ge])=>{const he=u(f).find(le=>String(le.id)===String(ge.id));he&&(G[pe]=he,console.log(`Household ${ge.id} in section ${pe}:`,{previousDataset:x==="tcja-expiration"?"tcja-extension":"tcja-expiration",newDataset:x,oldNetChange:ge["Total Change in Net Income"]||ge["Change in Household Net Income"],newNetChange:he["Total Change in Net Income"]||he["Change in Household Net Income"],oldPercentChange:ge["Percentage Change in Net Income"],newPercentChange:he["Percentage Change in Net Income"],oldFields:Object.keys(ge).filter(le=>le.includes("Income")).map(le=>({[le]:ge[le]})),newFields:Object.keys(he).filter(le=>le.includes("Income")).map(le=>({[le]:he[le]}))}))}),$e.forEach(pe=>{if(pe.viewType==="group"&&!G[pe.id]){const ge=u(f).filter(le=>pe.filter(le)),he=er(ge);he&&(G[pe.id]=he)}}),ae(S,G),ae(S,u(S)),k){const pe=u(f).find(ge=>String(ge.id)===String(k));pe?(ae(p,pe),Gr(pe.id)):ae(p,null)}U=!0,Wr((B=u(p))==null?void 0:B.id,x),(oe=u(V))!=null&&oe.renderVisualization&&u(V).renderVisualization(),u(Q)&&b>0&&requestAnimationFrame(()=>{Ge(Q,u(Q).scrollTop=b)})}async function j(){var x,b,k,F,G;try{const{householdId:I,baseline:P}=vo();if(console.log("handleUrlParams called with:",{householdId:I,baseline:P}),P&&P!==u(_)&&ae(_,P),Object.keys(s).length===0){ae(h,!0);try{console.log("Loading all datasets..."),s=await go(),console.log("Loaded datasets:",Object.keys(s),"lengths:",{"tcja-expiration":(x=s["tcja-expiration"])==null?void 0:x.length,"tcja-extension":(b=s["tcja-extension"])==null?void 0:b.length}),ae(f,s[u(_)]),console.log("Selected dataset:",u(_),"length:",u(f).length),y()}catch(A){console.error("Error loading data:",A),ae(v,A.message),ae(h,!1);return}ae(h,!1)}else ae(f,s[u(_)]);if(I&&u(f).length>0){console.log("Looking for household:",I,"in",u(f).length,"households");const A=u(f).find(J=>String(J.id)===I);if(A){console.log("Found household:",A),ae(p,A);const J=_o(A,$e);console.log("Target index:",J,"textSections length:",u(q).length);const B=((F=(k=$e[J])==null?void 0:k.id)==null?void 0:F.replace("-individual",""))||((G=$e[J])==null?void 0:G.id);B&&Ge(S,u(S)[B]=A),u(q)[J]&&u(Q)?setTimeout(()=>{u(q)[J].scrollIntoView({behavior:"smooth",block:"center"})},100):ae(z,{household:A,targetIndex:J})}}}catch(I){console.error("Error in handleUrlParams:",I),ae(v,`Failed to load data: ${I.message}`)}}kr(async()=>{console.log("Component mounted, starting initialization...");const x=I=>{var P;console.error("Global error caught:",I.error),ae(v,`An error occurred: ${((P=I.error)==null?void 0:P.message)||"Unknown error"}`),I.preventDefault()};if(window.addEventListener("error",x),window.addEventListener("unhandledrejection",x),window.self!==window.top){const I=new URLSearchParams(window.location.search);console.log("In iframe, URL params:",I.toString())}await j(),u(q).length>0&&(R=wo(u(q),w));const k=oo.subscribe(()=>{if(U){U=!1;return}j()});function F(I){var P;if(((P=I.data)==null?void 0:P.type)==="urlParams"){const A=new URL(window.location),J=new URLSearchParams(I.data.params);for(const[B,oe]of J)A.searchParams.set(B,oe);window.history.replaceState({},"",A),j()}}window.addEventListener("message",F);function G(I){u(Q)&&(Ge(Q,u(Q).scrollTop+=I.deltaY),I.preventDefault())}return window.addEventListener("wheel",G,{passive:!1}),window.addEventListener("mousemove",M),window.addEventListener("mouseup",Y),Ni(),()=>{k(),window.removeEventListener("message",F),window.removeEventListener("wheel",G),window.removeEventListener("mousemove",M),window.removeEventListener("mouseup",Y),window.removeEventListener("error",x),window.removeEventListener("unhandledrejection",x),Yr(R),Kr()}}),pa(()=>{Yr(R),Kr()}),kt(()=>i(),()=>{ae(c,$e[i()]||$e[0])}),kt(()=>(u(V),a(),o()),()=>{u(V)&&(a()||o())&&u(V).renderVisualization()}),kt(()=>(u(z),u(q)),()=>{if(u(z)&&u(q).length>0&&u(q)[u(z).targetIndex]){const{household:x,targetIndex:b}=u(z);ae(p,x),setTimeout(()=>{u(q)[b]&&u(q)[b].scrollIntoView({behavior:"smooth",block:"center"})},200),ae(z,null)}}),Bn(),ln();var T=uf();ma(x=>{var b=Xu();Ua.title="OBBBA Household Explorer",de(x,b)});var L=H(T);Mo(L,{get selectedDataset(){return u(_)},onDatasetChange:N});var C=ie(L,2),D=H(C);At(Ku(D,{get data(){return u(f)},get scrollStates(){return $e},get currentStateIndex(){return i()},get previousStateIndex(){return l()},get isTransitioning(){return a()},get interpolationT(){return o()},get randomHouseholds(){return u(S)},get selectedHousehold(){return u(p)},onPointClick:x=>te(x,!1),$$legacy:!0}),x=>ae(V,x),()=>u(V)),$(C);var E=ie(C,2),X=H(E);Nn(X,5,()=>$e,Cn,(x,b,k)=>{var F=Lt(),G=mt(F);{var I=P=>{var A=lf();let J;lr(A,"data-index",k);var B=H(A),oe=ie(H(B),2),pe=H(oe,!0);$(oe);var ge=ie(oe,2);{var he=ne=>{var se=nf();const ke=Xe(()=>(u(f),u(b),W(()=>u(f).filter(Se=>u(b).filter(Se))))),ue=Xe(()=>(fe(u(ke)),u(b),W(()=>m(u(ke),!1,u(b).id))));var qe=mt(se);{var Fe=Se=>{var Ce=Lt(),Te=mt(Ce);{var ht=Qe=>{var it=ju(),Ct=H(it);$(it),Ne(()=>_e(Ct,`Of the ${fe(u(ue)),W(()=>u(ue).total)??""} million households with market income below $50,000, OBBBA will increase the net income of ${fe(u(ue)),W(()=>u(ue).positivePercent)??""}% and reduce the net income of ${fe(u(ue)),W(()=>u(ue).negativePercent)??""}%. Let's take a look at one of them at random. You can also click on a dot to view information about a household.`)),de(Qe,it)},Wn=(Qe,it)=>{{var Ct=We=>{var at=Ju(),Yt=H(at);$(at),Ne(()=>_e(Yt,`Of the ${fe(u(ue)),W(()=>u(ue).total)??""} million households with market income between $50,000 and $200,000, OBBBA will increase the net income of ${fe(u(ue)),W(()=>u(ue).positivePercent)??""}% and reduce the net income of ${fe(u(ue)),W(()=>u(ue).negativePercent)??""}%. Let's take a look at one of them at random. You can also click on a dot to view information about a household.`)),de(We,at)},Vn=(We,at)=>{{var Yt=dt=>{var gt=Qu(),Ee=H(gt);$(gt),Ne(()=>_e(Ee,`Of the ${fe(u(ue)),W(()=>u(ue).total)??""} million households with market income between $200,000 and $1 million, OBBBA will increase the net income of ${fe(u(ue)),W(()=>u(ue).positivePercent)??""}% and reduce the net income of ${fe(u(ue)),W(()=>u(ue).negativePercent)??""}%. Let's take a look at one of them at random. You can also click on a dot to view information about a household.`)),de(dt,gt)},Yn=(dt,gt)=>{{var Ee=De=>{var ze=Zu(),ot=H(ze);$(ze),Ne(()=>_e(ot,`Of the ${fe(u(ue)),W(()=>u(ue).total)??""} million households with market income over $1 million, OBBBA will increase the net income of ${fe(u(ue)),W(()=>u(ue).positivePercent)??""}% and reduce the net income of ${fe(u(ue)),W(()=>u(ue).negativePercent)??""}%. Let's take a look at one of them at random. You can also click on a dot to view information about a household.`)),de(De,ze)},Ve=(De,ze)=>{{var ot=Re=>{var Ue=ef();const st=Xe(()=>(fe(u(ke)),u(b),W(()=>m(u(ke),!0,u(b).id))));var Ye=H(Ue);Qn(Ye,()=>(u(b),fe(u(st)),W(()=>u(b).description.replace("{totalPercentage}",u(st).affectedPercent).replace("{medianImpact}",u(st).medianChange)))),$(Ue),de(Re,Ue)};Ae(De,Re=>{u(b),W(()=>u(b).id==="all-households")&&Re(ot)},ze)}};Ae(dt,De=>{u(b),W(()=>u(b).id==="highest-income")?De(Ee):De(Ve,!1)},gt)}};Ae(We,dt=>{u(b),W(()=>u(b).id==="upper-income")?dt(Yt):dt(Yn,!1)},at)}};Ae(Qe,We=>{u(b),W(()=>u(b).id==="middle-income")?We(Ct):We(Vn,!1)},it)}};Ae(Te,Qe=>{u(b),W(()=>u(b).id==="lower-income")?Qe(ht):Qe(Wn,!1)})}de(Se,Ce)};Ae(qe,Se=>{u(ue)&&Se(Fe)})}var Me=ie(qe,2);{var Be=Se=>{var Ce=tf(),Te=H(Ce);$o(Te,{get household(){return u(S),u(b),W(()=>u(S)[u(b).id])},get selectedDataset(){return u(_)},get currentState(){return u(b)},sectionIndex:0,onRandomize:K}),$(Ce),de(Se,Ce)};Ae(Me,Se=>{u(S),u(b),W(()=>u(S)[u(b).id]&&u(b).id!=="all-households")&&Se(Be)})}de(ne,se)},le=(ne,se)=>{{var ke=ue=>{var qe=of(),Fe=mt(qe);{var Me=Ce=>{var Te=rf(),ht=H(Te);Qn(ht,()=>(u(b),W(()=>u(b).description))),$(Te),de(Ce,Te)};Ae(Fe,Ce=>{u(b),W(()=>u(b).description)&&Ce(Me)})}var Be=ie(Fe,2);{var Se=Ce=>{var Te=af(),ht=H(Te);Qn(ht,()=>(u(b),W(()=>u(b).content))),$(Te),de(Ce,Te)};Ae(Be,Ce=>{u(b),W(()=>u(b).content)&&Ce(Se)})}de(ue,qe)};Ae(ne,ue=>{u(b),W(()=>u(b).id==="intro")&&ue(ke)},se)}};Ae(ge,ne=>{u(b),u(f),W(()=>u(b).id!=="intro"&&u(f).length>0)?ne(he):ne(le,!1)})}var ce=ie(ge,2);{var ye=ne=>{var se=sf();de(ne,se)};Ae(ce,ne=>{k===0&&i()===0&&ne(ye)})}$(B),$(A),At(A,(ne,se)=>Ge(q,u(q)[se]=ne),ne=>{var se;return(se=u(q))==null?void 0:se[ne]},()=>[k]),Ne(ne=>{J=Ot(A,1,"text-section svelte-1se46nf",null,J,ne),Mi(A,`transform: translate(${u(d),W(()=>{var se;return((se=u(d)[k])==null?void 0:se.x)||0})??""}px, ${u(d),W(()=>{var se;return((se=u(d)[k])==null?void 0:se.y)||0})??""}px)`),_e(pe,(u(b),W(()=>u(b).title)))},[()=>({active:i()===k,dragging:u(me)===k})],Xe),ut("mousedown",A,ne=>g(ne,k)),de(P,A)};Ae(G,P=>{u(b),W(()=>u(b).viewType==="group")&&P(I)})}de(x,F)}),$(X),$(E),At(E,x=>ae(Q,x),()=>u(Q));var O=ie(E,2);{var re=x=>{Ao(x,{message:"Loading tax impact data..."})};Ae(O,x=>{u(h)&&x(re)})}var be=ie(O,2);{var ee=x=>{var b=cf(),k=H(b),F=ie(H(k),2),G=H(F,!0);$(F);var I=ie(F,2);$(k),$(b),Ne(()=>_e(G,u(v))),ut("click",I,()=>location.reload()),de(x,b)};Ae(be,x=>{u(v)&&x(ee)})}$(T),de(e,T),un(),r()}export{vf as component};
